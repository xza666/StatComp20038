"0","m=1000"
"0","k=3"
"0","p=2"
"0","set.seed(12345)"
"0","n1=n2=50"
"0","R=999"
"0","n=n1+n2"
"0","N=c(n1,n2)"
"0","eqdist.nn=function(z,sizes,k){"
"0","  boot.obj=boot(data=z,statistic=Tn,R=R,sim=""permutation"",sizes=sizes,k=k)"
"0","  ts=c(boot.obj$t0,boot.obj$t)"
"0","  p.value=mean(ts>=ts[1])"
"0","  list(statistic=ts[1],p.value=p.value)"
"0","}"
"0","p.values=matrix(NA,m,3)"
"0","for(i in 1:m){"
"0","  x=matrix(rnorm(n1*p,0,1),ncol=p)"
"0","  y=matrix(rnorm(n2*p,0,1.5),ncol=p)"
"0","  z=rbind(x,y)"
"0","  p.values[i,1]=eqdist.nn(z,N,k)$p.value"
"0","  p.values[i,2]=eqdist.etest(z,sizes=N,R=R)$p.value"
"0","  p.values[i,3]=bd.test(x=x,y=y,num.permutations=999,seed=i*12345)$p.va"
"0","}"
"0","alpha=0.1"
"0","pow=colMeans(p.values<alpha)"
"0","print(pow)"
"1","[1]"
"1"," 0.478"
"1"," 0.585"
"1"," 0.937"
"1","
"
