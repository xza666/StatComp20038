"0","maxout=function(x,y){"
"0","  X=x-mean(x)"
"0","  Y=y-mean(y)"
"0","  outx=sum(X>max(Y))+sum(X<min(Y))"
"0","  outy=sum(Y>max(X))+sum(Y<min(X))"
"0","  return(max(c(outx,outy)))"
"0","}"
"0","n1=20"
"0","n2=30"
"0","mu1=mu2=0"
"0","sigma1=sigma2=1"
"0","m=1000"
"0","p=numeric(m)"
"0","for(i in 1:m){"
"0","  x=rnorm(n1,mu1,sigma1)"
"0","  y=rnorm(n2,mu2,sigma2)"
"0","  z=c(x,y)"
"0","  R=999"
"0","  reps=numeric(R)"
"0","  t0=maxout(x,y)"
"0","  for(j in 1:R){"
"0","    k=sample(1:(n1+n2),size=n1,replace=FALSE)"
"0","    x1=z[k]"
"0","    y1=z[-k]"
"0","    reps[j]=maxout(x1,y1)"
"0","  }"
"0","  p[i]=mean(c(t0,reps)>=t0)"
"0","}"
"0","print(mean(p))"
"1","[1]"
"1"," 0.603817"
"1","
"
