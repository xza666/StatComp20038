"0","n=20"
"0","m=1000"
"0","sigma1=matrix(c(1,0,0,1),2,2)"
"0","sigma2=matrix(c(100,0,0,100),2,2)"
"0","epsilon=c(seq(0,0.15,0.01),seq(0.15,1,0.05))"
"0","N=length(epsilon)"
"0","pwr=numeric(N)"
"0","cv=qchisq(0.95,4)"
"0","for(j in 1:N){"
"0","  e=epsilon[j]"
"0","  sktests=numeric(m)"
"0","  for(i in 1:m){"
"0","    x=matrix(rep(0,40),nrow=20,ncol=2)"
"0","    for(k in 1:n){"
"0","    if(runif(1)<=1-e) x[k,]=mvrnorm(1,rep(0,2),sigma1)"
"0","    else x[k,]=mvrnorm(1,rep(0,2),sigma2)}"
"0","    S=matrix(c(var(x[,1]),0,0,var(x[,2])),2,2)"
"0","    sigma.hat=(n-1)*S/n"
"0","    b=skm(x,sigma.hat,n)"
"0","    sktests[i]=as.integer(n*b/6>cv)"
"0","  }"
"0","  pwr[j]=mean(sktests)"
"0","}"
"0","plot(epsilon,pwr)"
