"0","skm=function(x,sigma,n){"
"0","  xbar=matrix(rep(colMeans(x),n),nrow=n,byrow=TRUE)"
"0","  sum=sum(((x-xbar)%*%solve(sigma)%*%t(x-xbar))^3)"
"0","  return(sum/(n^2))"
"0","}"
"0","library(MASS)"
"0","m=1000"
"0","n=c(10,20,30,50,100,500)"
"0","cv=qchisq(0.95,4)"
"0","p.reject=numeric(length(n))"
"0","for(i in 1:length(n)){"
"0","  sktests=numeric(m)"
"0","  for(j in 1:m){"
"0","    sigma=matrix(c(1,0,0,1),2,2)"
"0","    x=mvrnorm(n[i],rep(0,2),sigma)"
"0","    S=matrix(c(var(x[,1]),0,0,var(x[,2])),2,2)"
"0","    sigma.hat=(n[i]-1)*S/n[i]"
"0","    b=skm(x,sigma.hat,n[i])"
"0","    sktests[j]=as.integer(n[i]*b/6>cv)"
"0","  }"
"0","  p.reject[i]=mean(sktests)  "
"0","}"
"0","print(p.reject)"
"1","[1]"
"1"," 0.026"
"1"," 0.040"
"1"," 0.042"
"1"," 0.041"
"1"," 0.056"
"1"," 0.047"
"1","
"
