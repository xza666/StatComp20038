"0","rw.Metropolis=function(sigma,x0,N){"
"0","  f=function(x) 0.5*exp(-abs(x))"
"0","  x=numeric(N)"
"0","  x[1]=x0"
"0","  u=runif(N)"
"0","  k=0"
"0","  for(i in 2:N){"
"0","    y=rnorm(1,x[i-1],sigma)"
"0","    if(u[i]<=f(y)/f(x[i-1])) x[i]=y"
"0","    else{"
"0","      x[i]=x[i-1]"
"0","      k=k+1"
"0","    }"
"0","  }"
"0","  return(list(x=x,k=k))"
"0","}"
