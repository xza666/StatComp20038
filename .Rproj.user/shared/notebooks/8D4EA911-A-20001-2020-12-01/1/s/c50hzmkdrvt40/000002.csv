"0","library(Rcpp)"
"0","library(microbenchmark)"
"0","sourceCpp(code=""#include <Rcpp.h>"
"0","using namespace Rcpp;"
"0","// [[Rcpp::export]]"
"0","NumericMatrix rwMC(double sigma,double x0,int N) {"
"0","  NumericMatrix mat(N, 2);"
"0","  mat(0,0)=x0;"
"0","  mat(0,1)=0;"
"0","  double y=0,u=0;"
"0","  for(int i = 2; i < N+1; i++) {"
"0","    y=rnorm(1,mat(i-2,0),sigma)[0];"
"0","    u=runif(1,0,1)[0];"
"0","    if(u<=exp(-abs(y))/exp(-abs(mat(i-2,0)))){"
"0","      mat(i-1,0)=y;"
"0","      mat(i-1,1)=mat(i-2,1);"
"0","    }"
"0","    else{"
"0","      mat(i-1,0)=mat(i-2,0);"
"0","      mat(i-1,1)=mat(i-2,1)+1;"
"0","    }"
"0","  }"
"0","  return(mat);"
"0","}"")"
