<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zi’ang Xu" />

<meta name="date" content="2020-12-17" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Zi’ang Xu</h4>
<h4 class="date">2020-12-17</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Example1:我们生成了一个简单的50对随机值的二维图形的例子, 并通过对plot函数的参数进行相关的选取,最终绘制出的一个较为完善的图形.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>x=<span class="kw">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>y=<span class="kw">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightyellow&quot;</span>, <span class="dt">col.axis=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">2.5</span>, <span class="fl">0.25</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab=</span><span class="st">&quot;Fifty random values&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ten other values&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">tcl=</span><span class="op">-</span>.<span class="dv">25</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="kw">title</span>(<span class="st">&quot;How to customize a plot with R (bis)&quot;</span>, <span class="dt">font.main=</span><span class="dv">3</span>, <span class="dt">adj=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA+VBMVEUAAAAAADIAAFoAAPUAAPoAAP8AOjIAOloAOn4AZloAZp8AZuo6AAA6ADI6AFo6APU6APo6AP86OgA6OjI6On46Zlo6Zn46Zp86kJ86kME6kOVmAABmADJmAP9mOgBmOjJmZjJmZlpmkH5mkJ9mkMFmtp9mtsFmtuCQOgCQOv+QZgCQZjKQkDKQkFqQtsGQ25+Q2+C2ZgC2ZjK2Zn62Zv+2kDK2kFq223622+C2/5+2/+DbkDLbkFrbkPrbtlrbtn7btp/b28Hb/5/b/8Hb/+D/AAD/tlr/tn7/tvX/237/25//28H/2/D//wD//5///8H//+D//+X//+oNSS59AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOyElEQVR4nO2dDZvbOBHHveXS2wvhreXay+UoHEe7aaGwXgqUhu1xsGs225J4+f4fBo3e7dgey5JsZTv/52m6sa2R9PNoJDu2lJWkTmVTFyB1ESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBA1Atr/+Z2zITRNkZ05GxXanJz3yornwHfWUxSZ0MnTK2vjg3flxhSqWr7NqTyyCdB+fXrVsLlTeJp6ofsrf1AB0poV5CB21lIwDkpzvW23OqscWC1fob41Adqt5g1buzUkTU/VgXRmxXceHJHL6t6uNYX9et51WnerpfijCdB2sURLHSJNb9Pz2veOrPjO+hH7tXIU4yb8r3bWnB8og+P2a/EpcII/MoO3v19kmdVm+fcnV8qqOPr9I9awv7s6TMPK+P2z7ORFuX0mUkGh92vj53AopDTm2Y4nb9VX5uL/WGSfw3cRHLRpmZWqoyk75CB2shTvmfXfKWO7lXIU5UqyEkX2guXy5EpjV/UxvpVB7oX8FFEqZ5lAdrwu2gXNd3Ecz6FQFT5Is8ke86j4mm9ZCuu7lQYkD9UnUH7XISF/8Af1nXMwpnNdqqJadvgndm6yRzxz5S1FJjzqw4Wuj6jE5uQ3qsDKmCqVik7Z4ozR+mJ1ZrVH2Mfqwk7X7VqFdvb9q6ty/4plKtyUG+Qn5HbFjq+nyfmJuOAn/T2UTzv3+8WDt8qcCQk5c7Zyf6G+M19j3rPPIeWBaUVxWy07zwF2ssTM2v5Cd0smRhv73EgOudw+gwNFal0fC9CS1fX56sx0c9w3NgK6bv/ye6mdjxvcZJ//sTHNXpAVW0RFZIYsyTvrUBMsPvzwwz9fmRbADxemoPLGtIkb20rZeQ4yRnMzJt7kEs/D70x7mJtcwMFE+XR9LEDMYn76r9XSOJBdH1UaE+YqIQjaLB9b1NPIdCIXKKkytOH+rIJRprCz011pYpIcpBLBy5iGrExJTNl5DnynPKu5qpBIvc+tflx4g8xFtH6eRtXHikGrOTPKOjUzTiqs+qjWa8Kcti3PIwuuEJdqaaw4JTDJssggoIKRBsTO8eMvv/2tzkUOQ5Spimldz12l7DwHvrOSuSmrdZLlAFGagi/al0V9TIWz9ZyR3q+/0rw5eblfBwn5HUwJz4XoIDOGjfU04iCRqwznMMrNs/mVOve2ZNJCB21xtrUp27Qp6L5SdhEU+TDRytw+y8a8LJ/45A2t4JB0fUzqLH/IXfihdlw5goIgysLXXG3MWNj7C+9FeHee8WJDZIXB10Ea0bYKU9Kcj3J1z8tj8oe/KjdkZXwL4Vu3uDWQZDF5rsOuMq0HKGDFLrvIwYz+jKep6wnLheQIAerDrMrymfpYASzLebvPTX8O7n9W1nv5QncCPOKdPBIxTR5UTyPPuMSUqW7GNKu6eRVGdT/xxapiyjatjyrtsss4xHZW4p9xx9LuaeQw8cuF7NUFVF0fq0vPRKLculK74Bxuf82i/gszkPv+mRzH7dgfT/+9VjFNjKtqaYSDylxy1btsLArsvFmdCg/SJ0/fqwqw0MIO4Jalr5viXGSWa5iyCyyws5J5acdP2WspQCyX/zwS40kTo1WuikeatzuGX9j2FHZrwQS6NAHVr8aDS1+LNsvErzQBDbnf4qi8K4f92uBLElDEeydKRZePbqzskwSUkggQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAIQoKKC7t6/8qXUfNpyr3Ot29nM1mXwcy5qIjAXT38rPz8nL24yDGnHQkgD7+Am5WXv6o6XYKAdK6YW4UzFhPHRWgN+RBnbo5jNL8Bx3v4nTpiADdNMfo2B5kFDWfqobUqcF/hhtLXQPqdNnGhwBxXc5af5QkQCWMg9r8hwBxXc64JhgHTaMjulidRgQIEQFCRIAQESBEqQKa5rqiQckCmuTKtEEECBEBQnRPAMULWapO8Njnxnqy28tYALkCiuZwqk45vA43L3OvpyfvMaCdfOmq8+HPvsZCKEVA8PT2hgDVpJvYHF5p8HxAebqBYicgrwBugnQm32ry0HSXGt2AfLwr1W7eUZ8UoCEtYgRArI2dXuV+0ycEAjSgPvEBFSfnGwjSXoQmBNTldiEAwQtAMCNMCt28V32CG7TGQQAohYFikoCUB3W+Z9bXmKc66zPkqjRgDNogr3L2NOanbkADhsxBBopiMgTPd2kTBeSlFMdBxw/o48+aQ/k9BqRnG+nTi/3vV40P4I0ykp7Yg3r18jezWVRAnRoEyOeGbK1OPe4o3sy+vjk2QB5uV6tTv4FiE6D4D3FyTQ2o36XGp+tBPe8oTgmoFk4q39tCTQBAqhfrd6UxIaCarquAahz0rnBNrJ9iAnLrcayqNwFSX+8VIKfKEKD+R0cEZCbt6zeSPj5A4QaKfkoVkM9lCQFCZP1w2L+JYcZ8FAaQaEwhAeWnVxt7nlQvYz7yAmQNfAIDgt97CvhVY/J70j0BXR+qnrq+D7XUuNv6VWP703f833CNOFBs4Xhtd1tNrDosdQKCXzV235wnAKinEED6QwLqgNAPEL+Mz5cJNLGeGh0Q3CpjPZnfDJhOgHxGb1MACiE3QM1V9Et97wG1uNXh1rEBhZkcNACgznpbW4cCOuTf04Ny/99VkwBk3SFrBHSYqn8TKyorgQyRDyCrZtVzXTkWA2TvDQ6orC4cMEAIoPZBr/5qbTzcWQHU2QdeVxBfV65BDgD1GkmDontQtXR+gJCcWio9oOfUI+kRYlAroIa44QcILYEzoFF6sRqgmt+nDSiMBgKyiBCgg9JVOxgChAE66G9q3uZXwOMHdOAyYR8D6h4cNMq6H+Sv5AENkHVHMZixNiGAKqPIUI3KW/ox4BBroTiNpNXGVFylRUOeUcSMOelIALnopmV6pYGAUmlLLXKvE0zC2TwR5/2e3KTv+2J3L2EOszcTTHbrq2G+6vy+2HST3frKjnb9e0nn98U+/vy8bHoAZqSnXD1UAdR7nOX8vpgIP1PMBqw0NKy3AEKMOb8vNhqg1lYwdGDQAggx5vy+WFsTs40FUWsrmAZQ7/fFRgvSqQHqq9G6+WMFNNpAMTFAav3uHtdil0EvNVrlBKhPz+YHKMjKphMC6uFVNsSWO5cNsh7B81fagJwy0Rrzhpmb0gLkO3NQxVgYtQNqiDeDAaHBS9XJ8wHgqrEgcrrrGu+226B3NbqMTaO4gNI05qTogOARYJD/7C/u19ohbrqOBsh//iD3ooaoXGRAuYlB3jNQTQQo2q3/mgf5G5sGUDwFD9L3FtB2EWb+oOkAxWlm+o4ijz4BZqCaEFAUT6w93eH/Mss9BaQuVgOMg+4noEk9KFDsiAooYAyKNiLBFBdQsF4sjJwu5VWauIDSMjbkETwC1DcNAULSEKCWNFFH0okZS+4x4NSMpQfI4ZfV2FOVgtID5PLLauSpSkFdgIaMkYZrwC+rY0xV2gloVO9y/2V1lKlKu7xkEkBuv6yGATS0pUwCiC8N1Vth5nKN93t6SA16VyOQBwUAFD9gDwobCQEa6E39wbrUCRYK52up3wNAvdM5v6sB+hQBOa3tMzEgq3mMBshtbZ9pATXaiA1oirV9jgrQFGv71DuS5p6lu78ZOwaNv7YPGk+6qzJuLzbFrxpWOxsEaOBAcQCgEBof0FARICxbp5F0mKfIy2MC1F8ECBEBQkSAkIA09ZP2OKD4t+g7z8HkHmQNFOOjaClDyoBSEAFCRIAQoYCCiQAhIkCICBCiuICijQLQgWIwRQY0yTUHAUJEgBARIEQECBEBQkSAELnX6e6lesgjgDEXHQmgu5efnZeXswlm4rxuUtQcQc51SmEmzjHvUw+s05QTTR4FoDfkQZ26OYzSY87lmjygm+YYTR4k1eA/w40NUaqA5FOul218PnlAQpez1lv8BKiEcVCb/xAgLmhns5bJSrN7pkGA+sjVqOPxkc1XjydAyPEECDmeACHHH+lvfeOJACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAIYoBqOMZtDa1zcx4qPaluP1tlw1ljwCo6xm0FrXOzHigjhUWvW2XTWWPAKjrGbRmtc/MWFfXGp2+tkGHZY8WgxxOc8fMjHU5w3ewbSWyyh4NUPMzaG3qDahjnWBf20ZvRvCg1meIWg7vWYmulaZ9bZsEdtkjAWp7Bq31+IQAVcseB5Cj/yTVxGplDwsIfQat+XgHQM49pCugetljeFDHM2ht6lsJ927eEdBB2aOMgxzbV+lQCfeBohOgw7JHANT1DFqb+leifSluf9tNZaeLVUQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQjQ+oFxOrXLG1xrYZNmy6P0wSOGyAFqYtQwmAGSvEgjLcjpU5FMEdEaAatKAWAW2C9HcTl/BYuUbvmL57pvXsMIQtMQzOOj5iv8BjfHkNQAq2J5lWW4XsGcJJjiI7QL+A4Q6qWjFqilDopLn6AJuWkD6Hyxful+fic1wQM5gbVhldyv2AX/k7IgCFmGEdc13qzmrKuwBlmJxWLEiPLNukhpA8H27WAqKTiujJwII/m1/ci42L8GNzoVP8G/sD+Ef+ck5LHjKHQXqW8oPXmHgxA63kmpAYgVidhbc15GdrBerwgGP2QhyOnQU6iD4EDXjXGC3QmY+REIZpFRSnZpvZsftVq6EEvEgOLtyJW4BiMWMB39bGECbKiAev2qAADIYt5JqQGpowRriccYg1qb+BE1DbjYVd/AgBvnv0FKtpFUP0iVw6QtTAbRfP5bblUOVMhyfGX+BWGvFoDqg3epbiORWUhXBqj2+U/+fBCCo8iZbms3SA7KlBsT7oVovVgfEwtu8mnS/Pr1ijUqkBs/hruQ0mkoAEKsX2yT7MCsGnZyzGlVGMrVx0AGgIqsnheUbn6txkHAtxwWbk7lY3f7SZ53yeEoG0GY5dQmalQig7cJrofuI+j+8SbJJF77I3gAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Example2:下表给出了纽约1973年5-9月每日空气质量中前六日的相关数据,其中NA为缺省数据,由此绘制成的一个表格.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(airquality),<span class="dt">pad=</span><span class="dv">0</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Ozone</th>
<th align="right">Solar.R</th>
<th align="right">Wind</th>
<th align="right">Temp</th>
<th align="right">Month</th>
<th align="right">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">41</td>
<td align="right">190</td>
<td align="right">7.4</td>
<td align="right">67</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">118</td>
<td align="right">8.0</td>
<td align="right">72</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">149</td>
<td align="right">12.6</td>
<td align="right">74</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">313</td>
<td align="right">11.5</td>
<td align="right">62</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">14.3</td>
<td align="right">56</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">NA</td>
<td align="right">14.9</td>
<td align="right">66</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>我们加上参数format，可以得到生成表格的另一种样式：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(airquality),<span class="dt">format=</span><span class="st">&quot;html&quot;</span>,<span class="dt">pad=</span><span class="dv">0</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Ozone
</th>
<th style="text-align:right;">
Solar.R
</th>
<th style="text-align:right;">
Wind
</th>
<th style="text-align:right;">
Temp
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
7.4
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
8.0
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
12.6
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
313
</td>
<td style="text-align:right;">
11.5
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
14.9
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
<p>Example3:列举的公式如下： <span class="math display">\[F_n(x)=\frac{1}{n}\sum_{i=1}^n \textbf{1}[X_i\leq x],F_n(y)=\frac{1}{n}\sum_{i=1}^n \textbf{1}[X_i\leq y].\]</span> <span class="math display">\[\sqrt{n}\left( \sqrt{F_n(x)}-\sqrt{F(x)} \right)\rightarrow N\left( 0,F(x)(1-F(x))\cdot(\frac{1}{2\sqrt{F(x)}})^2 \right).\]</span> <span class="math display">\[P(F(X_{(n)})-F(X_{(1)})&gt;\beta)=P(Y_{(n)}-Y_{(1)}&gt;\beta).\]</span></p>
</div>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<p>The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math display">\[F(x)=1-\left( \frac{b}{x}\right)^a,x\ge b&gt;0,a&gt;0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution.Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
</div>
<div id="answer-3.3" class="section level2">
<h2>Answer 3.3</h2>
<p>由于<span class="math inline">\(F(x)=1-\left( \frac{b}{x}\right)^a,x\ge b&gt;0,a&gt;0\)</span>, 我们可以得到其反函数为： <span class="math display">\[F^{-1}(U)=\frac{b}{(1-U)^{\frac{1}{a}}}.\]</span> 下面用逆变换法来生成分布为Pareto(2,2)的随机数.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>n=<span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>a=b=<span class="dv">2</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>x=b<span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>a))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">30</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">Pareto</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>y=<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">35</span>,<span class="fl">0.1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">*</span>y<span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过理论密度曲线与生成的随机数直方图相比较, 我们可以认为该随机数的生成比较合理.</p>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution.Generate iid $U_1,U_2,U_3$ Uniform(-1,1).If<span class="math inline">\(|U_3|\ge|U2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>,deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>,and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-3.9" class="section level2">
<h2>Answer 3.9</h2>
<p>根据所给的算法, 我们写出以下函数select来生成随机数：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>select=<span class="cf">function</span>(n){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>  U=<span class="kw">runif</span>(<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(U[<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(U[<span class="dv">2</span>])<span class="op">&amp;&amp;</span><span class="kw">abs</span>(U[<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(U[<span class="dv">1</span>])) y=U[<span class="dv">2</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>  <span class="cf">else</span> y=U[<span class="dv">3</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>  <span class="kw">return</span>(y)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>接下来我们根据所写的函数来生成满足给定条件的10000个随机数：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>y=<span class="kw">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>  y[i]=<span class="kw">select</span>(<span class="dv">3</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>  i=i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>根据生成的随机数,我们用hist函数做出其直方图，并与理论概率密度函数相比较：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">hist</span>(y,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>a=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="kw">lines</span>(a,<span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过理论密度曲线与生成的随机数直方图相比较, 我们可以认为该随机数的生成比较合理.</p>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="answer-3.10" class="section level2">
<h2>Answer 3.10</h2>
<p>记我们通过该算法生成的随机变量为<span class="math inline">\(U\)</span>, 我们接下来考虑随机变量<span class="math inline">\(U\)</span>的分布函数, 首先考察<span class="math inline">\(x&gt;0\)</span>的情况，我们取<span class="math inline">\(U_3=u\)</span>的条件概率，便得到以下公式： <span class="math display">\[\begin{align*}
P(U\le x) &amp;= P(U\le x|U_3)\\
&amp;= \frac{1}{2}\left( \int_{-1}^{-x}1-|u|+|u|(1-|u|+\frac{x-u}{2})du+\int_{-x}^x du+\int_x^1 |u|\frac{x+u}{2}du\right)
\end{align*}\]</span> 上述公式的推导是建立在确定了<span class="math inline">\(U_3\)</span>的取值后, 通过考察<span class="math inline">\(U_1\)</span>和<span class="math inline">\(U_2\)</span>的合理的取值区间来使得条件成立来计算的. 经计算, 我们可以得到: <span class="math display">\[P(U\le x)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}.\]</span> 对于<span class="math inline">\(x&lt;0\)</span>的情况, 我们类似的可以得到以下公式: <span class="math display">\[\begin{align*}
P(U\le x) &amp;= P(U\le x|U_3)\\
&amp;= \frac{1}{2}\left( \int_{-1}^x 1-|u|+|u|(1-|u|+\frac{x-u}{2})du +\int_{-x}^1 |u|\frac{x+u}{2}du \right)\\
&amp;= -\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}.
\end{align*}\]</span> 将上述两种情况合并, 便得到: <span class="math display">\[F(x)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2},|x|\le1.\]</span> 对<span class="math inline">\(x\)</span>求导，我们便得到其cdf为： <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),|x|\le1.\]</span> 从而说明该算法生成的随机数是合理的.</p>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y} \right)^r,y\ge0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-3.13" class="section level2">
<h2>Answer 3.13</h2>
<p>由于<span class="math inline">\(F(y)=1-\left(\frac{\beta}{\beta+y} \right)^r,y\ge0.\)</span>我们可以得到其反函数为： <span class="math display">\[F^{-1}(U)=\frac{\beta}{(1-U)^{\frac{1}{r}}}-\beta.\]</span> 接下来我们用逆变换生成法来生成满足给定条件的1000个随机数：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>n=<span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>r=<span class="dv">4</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>b=<span class="dv">2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>x=b<span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r))<span class="op">-</span>b</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">30</span>,<span class="dt">main=</span><span class="st">&quot;pareto cdf with r=4 and beta=2&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="fl">0.02</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过理论密度曲线与生成的随机数直方图相比较, 我们可以认为该随机数的生成比较合理.</p>
</div>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\frac{\pi}{3}} sin t dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-5.1" class="section level2">
<h2>Answer 5.1</h2>
<p>我们对该积分进行一个改写, 即: <span class="math display">\[\int_0^{\frac{\pi}{3}} sin t dt=\frac{\pi}{3}E[sinX],X\sim U(0,\frac{\pi}{3})\]</span> 接下来进行数据模拟计算:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>m=<span class="fl">1e5</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>x=<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>theta.hat=<span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 0.500536 0.500000</code></pre>
<p>通过与理论结果相比较, 我们发现MC算法是比较合理的.</p>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6.Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method.Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise.</p>
</div>
<div id="answer-5.7" class="section level2">
<h2>Answer 5.7</h2>
<p>首先我们用对偶MC算法和简单MC算法对<span class="math inline">\(\theta\)</span>进行估计, 我们用以下函数进行两个算法的实现:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>MC.theta &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>  theta=<span class="kw">mean</span>(<span class="kw">exp</span>(u))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  <span class="kw">return</span>(theta)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>上述函数可以计算出两种算法运行一次的积分估计值, 我们重复1000次, 来得到两种算法估计的方差, 其中MC1表示普通MC估计, MC2表示对偶MC估计.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>MC1=MC2=<span class="kw">numeric</span>(m)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.theta</span>(<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.theta</span>(<span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>}</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="kw">c</span>(<span class="kw">var</span>(MC1),<span class="kw">var</span>(MC2),(<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 2.335864e-04 7.537050e-06 9.677334e-01</code></pre>
<p>通过上述两种算法的方差比较可以发现, 运用对偶MC算法来估计可以打打减小估计的方差, 在上述的模拟中, 该算法的方差减小了大约97%, 这个结果是比较理想的.</p>
<p>最后我们来进行两种模拟结果与理论值的一个比较, 我们把两种模拟的1000次结果取一个平均来得到我们最终的模拟结果：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="kw">mean</span>(MC1),<span class="kw">mean</span>(MC2),<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1.718531 1.718277 1.718282</code></pre>
<p>从结果我们可以发现, 两种算法的估计结果都与理论值很接近, 并且改良后的对偶MC算法估计更优.</p>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic,we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2.\)</span> Derive <span class="math inline">\(c^*\)</span> for the general case.That is ,if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>,find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2\)</span> in equation(5.11).(<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-5.11" class="section level2">
<h2>Answer 5.11</h2>
<p>根据定义我们可以给出<span class="math inline">\(\hat\theta_c\)</span>的方差表达式： <span class="math display">\[\begin{align*}
Var(\hat\theta_c) &amp;=Var(c\hat\theta_1+(1-c)\hat\theta_2)\\
&amp;=c^2 Var(\hat\theta_1)+(1-c)^2 Var(\hat\theta_2)+2c(1-c)Cov(\hat\theta_1,\hat\theta_2)\\
&amp;= (Var(\hat\theta_1)+Var(\hat\theta_2)-2Cov(\hat\theta_1,\hat\theta_2))c^2+(2Cov(\hat\theta_1,\hat\theta_2)-2Var(\hat\theta_2))c+Var(\hat\theta_2)
\end{align*}\]</span> 我们考察上述表达式,本质上是一个二次函数求最值的问题. 首先, 我们有: <span class="math display">\[Var(\hat\theta_1-\hat\theta_2)=Var(\hat\theta_1)+Var(\hat\theta_2)-2Cov(\hat\theta_1,\hat\theta_2)\ge0\]</span> 由于<span class="math inline">\(\hat\theta_1\)</span>和<span class="math inline">\(\hat\theta_1\)</span>是两个不同的估计量,即上述不等式取不到等号, 从而二次项系数为正. 再考虑对称轴, 记对称顶点为<span class="math inline">\(x_m\)</span>, 则: <span class="math display">\[x_m=-\frac{2Cov(\hat\theta_1,\hat\theta_2)-2Var(\hat\theta_2)}{2(Var(\hat\theta_1)+Var(\hat\theta_2)-2Cov(\hat\theta_1,\hat\theta_2))}=\frac{Var(\hat\theta_2)-Cov(\hat\theta_1,\hat\theta_2)}{Var(\hat\theta_1)+Var(\hat\theta_2)-2Cov(\hat\theta_1,\hat\theta_2))}\]</span></p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance function <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are close to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1.\]</span> Which of your two important functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling?Explain.</p>
</div>
<div id="answer-5.13" class="section level2">
<h2>Answer 5.13</h2>
<p>我们选择以下两个函数来进行接近: <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.5)^2}{2}},f_2(x)=\frac{xe^{-\frac{x}{2}}}{4\Gamma(2)}.\]</span> 这两个函数一个取自正态分布<span class="math inline">\(N(1.5,1)\)</span>, 另一个取自Gamma分布<span class="math inline">\(\Gamma(2,2)\)</span>, 我们可以做出其图像:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">500</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>x=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>g=x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="kw">plot</span>(x,g,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>f1=<span class="kw">exp</span>(<span class="op">-</span>(x<span class="fl">-1.5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>f2=x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">gamma</span>(<span class="dv">2</span>)<span class="op">*</span><span class="dv">4</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a><span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过importance sampling方法进行积分估计:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>m=<span class="dv">10000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>theta.hat=se=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>g=<span class="cf">function</span>(x) {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>   <span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>x<span class="op">^</span><span class="dv">4</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>}</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>h=<span class="cf">function</span>(x){</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>  x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>x=<span class="kw">runif</span>(m)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>theta.hat[<span class="dv">1</span>]=<span class="kw">mean</span>(<span class="kw">g</span>(x))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>se[<span class="dv">1</span>]=<span class="kw">sd</span>(<span class="kw">g</span>(x))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a>x=<span class="kw">rnorm</span>(m,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>fg=<span class="kw">h</span>(x)<span class="op">/</span><span class="kw">dnorm</span>(x,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(m,<span class="dv">2</span>,<span class="fl">0.5</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a>fg &lt;-<span class="st"> </span><span class="kw">h</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dgamma</span>(x,<span class="dv">2</span>,<span class="fl">0.5</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a>theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a>se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true"></a>res &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">theta_hat=</span><span class="kw">round</span>(theta.hat,<span class="dv">5</span>), <span class="dt">se=</span><span class="kw">round</span>(se,<span class="dv">5</span>))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true"></a><span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true"></a><span class="kw">print</span>(res)</span></code></pre></div>
<pre><code>##                f0      f1      f2
## theta_hat 0.40426 0.40215 0.39631
## se        0.30622 0.30240 0.59081</code></pre>
<p>根据结果我们可以看到,<span class="math inline">\(f_1(x)\)</span>的选择更佳, 估计的标准差更小, 这点从概率密度曲线图上很容易看出, <span class="math inline">\(f_1\)</span>与目标曲线的贴合度更为接近一点.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level2">
<h2>Answer 5.15</h2>
<p>根据Example 5.13给出的优化, 我们可以得到以下算法:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>M=<span class="dv">10000</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>N=<span class="dv">50</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>T=<span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>est=<span class="kw">numeric</span>(N)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>g=<span class="cf">function</span>(x){</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>  <span class="kw">exp</span>(<span class="op">-</span>x<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>}</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    u=<span class="kw">runif</span>(M)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>    x=<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>    fg=<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>    T[j]=<span class="kw">mean</span>(fg)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>  }</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>  est[i]=<span class="kw">sum</span>(T)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>}</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(est),<span class="kw">sd</span>(est)),<span class="dv">5</span>) </span></code></pre></div>
<pre><code>## [1] 0.52479 0.00007</code></pre>
<p>通过给出的结果可以看到, 所得到的估计标准差相比于Example 5.10中的方法有了极大幅度的减小.</p>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,\cdots,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters.Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>.Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-6.4" class="section level2">
<h2>Answer 6.4</h2>
<p>根据对数正态分布的定义, 我们有<span class="math inline">\(lnX_1,\cdots,lnX_ni.i.d\sim N(\mu,\sigma^2)\)</span>,所以我们第一步将原样本数据取对数得到一个新的样本.我们记样本方差为<span class="math inline">\(S\)</span>,那么可以得到： <span class="math display">\[T=\frac{\sqrt{n}(\bar{X}-\mu)}{S}\sim t_{n-1}.\]</span> 从而我们经过变形可以得到<span class="math inline">\(\mu\)</span>的置信系数为95%的置信区间为: <span class="math display">\[\left[\bar{X}-\frac{S}{\sqrt{n}}t_{n-1}(0.025),\bar{X}+\frac{S}{\sqrt{n}}t_{n-1}(0.025)\right].\]</span> 下面我们用蒙特卡洛方法获得经验置信水平, 其中我们的模拟基于<span class="math inline">\(lnX\sim N(0,4)\)</span>进行:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>n=<span class="dv">10000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>UCL=<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>level=<span class="kw">numeric</span>(m)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a>  x=<span class="kw">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>  x=<span class="kw">log</span>(x)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>  UCL[i,<span class="dv">1</span>]=<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a>  UCL[i,<span class="dv">2</span>]=<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>  <span class="cf">if</span>(UCL[i,<span class="dv">1</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;&amp;</span>UCL[i,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">0</span>)level[i]=<span class="dv">1</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a>  <span class="cf">else</span> level[i]=<span class="dv">0</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a>}</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">mean</span>(level))</span></code></pre></div>
<pre><code>## [1] 0.946</code></pre>
<p>通过蒙特卡洛方法模拟结果经验置信水平为0.946, 与理论0.95十分接近.</p>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean,but the sample data are non-normal.Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95.Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>.Compare your t-interval results with the simulation results in Example 6.4.(The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>n=<span class="dv">20</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>UCL=<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>level=<span class="kw">numeric</span>(m)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>  x=<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a>  UCL[i,<span class="dv">1</span>]=<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>  UCL[i,<span class="dv">2</span>]=<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>  <span class="cf">if</span>(UCL[i,<span class="dv">1</span>]<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;&amp;</span>UCL[i,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">2</span>)level[i]=<span class="dv">1</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a>  <span class="cf">else</span> level[i]=<span class="dv">0</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a>}</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">mean</span>(level))</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<p>运用蒙特卡洛方法得到的经验置信水平为0.918, 虽然该方法与理论水平0.95有差距, 这是显然的, 因为我们假定在了正态分布的条件下, 但时可以发现, 在这种方法下, 均值的置信水平比方差的置信水平更为稳健.</p>
</div>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha,\alpha)\)</span> distributions and comment on the results.Are the results different for heavy-tailed symmetric alternatives such as t(v)?</p>
</div>
<div id="answer-6.7" class="section level2">
<h2>Answer 6.7</h2>
<p>类似于Example 6.8, 我们可以得到该问题的假设检验为: <span class="math display">\[H_0:\sqrt{\beta_1}=0;H1:\sqrt{\beta_1}\neq0.\]</span> 我们通过变化Beta分布中的参数<span class="math inline">\(\alpha\)</span>的取值, 作出检验功效随参数<span class="math inline">\(\alpha\)</span>的变化曲线(检测水平<span class="math inline">\(\alpha=0.05\)</span>).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>n=<span class="dv">30</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>m=<span class="dv">10000</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>alpha=<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>M=<span class="kw">length</span>(alpha)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>power=<span class="kw">numeric</span>(M)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>cv=<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a>sk=<span class="cf">function</span>(x){</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>  xbar=<span class="kw">mean</span>(x)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>  m3=<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a>  m2=<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a>  <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a>}</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a>  sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a>    x=<span class="kw">rbeta</span>(n,alpha[i],alpha[i])</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true"></a>    sktests[j]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true"></a>  }</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true"></a>  power[i]=<span class="kw">mean</span>(sktests)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true"></a>}</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true"></a><span class="kw">plot</span>(alpha,power,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(alpha))</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true"></a><span class="kw">lines</span>(alpha,power)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZpAAZrY6AAA6ADo6AGY6ZpA6kNtmAABmADpmZmZmZrZmtv+QOgCQOjqQZgCQZmaQ29uQ2/+2ZgC2Zjq22/+2/7a2///bkDrb////tmb/tpD/25D/27b//7b//9v////Emdc2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKf0lEQVR4nO2djXbjthGFsdl4m8Zt4zaJ2q6s7tp4/3esSBA/pERcDDkgsPK9OXuOI4ED6NNgMANCkrFUVqb1AHoXAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQkDIg88OoFSBdc7pKyRDQrcxAyE6ECOhGjo0n1BSQYIYfKGPT8HMwoFns8//60jS6dJBl1ykPw1vshZALOwkbN88aA5IMoK6cs0z/BScnIC/PZ/AbR8g/3DJIu/erC01oYoSUB8nHXsU8IOc8xudCtnUe1JxPmEuOiwlgwsg+NqBkHs2rLzNrUmxLeWjNAXkYMTgnPuTbFBtTHlsNo9IxhHATl9SbZeMDA/LO0jOgloR8RRoSDgJajCANN8GT7DLz+MCAbKi7QgVmCWg2hCT5GR8goMUYzDTHUudZjuiDAbpJcULtZRNgsyuKTeuMcGHuYEBmUVz4GiPmiDfL2IcCZHxVmizwafket8luBlpkXKD3F9fvT18XVha3m44GFJOd4C1hETsS0Nn86v64+D9WzB273+E3VcOkircvpigUytflQEuMl+v9JWA5f37NmTt4QyjZ7LFJRJ7fQzggBr09/+b/vCwn2dzc0TtmYT8sLSxMfPKgVaxbD/KxebG2568oNi3Q2Uwu1FcMilPMJgsFuKTYtmgkb8/uTVrxnwaA4nKehOaS64o72Dy0nLnDAPmFPKxjPwigmolQOodSNveynYyV4u5EgztfhzGGoXN+FasIaLZi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" /><!-- --></p>
<p>从图中可以看出, 该检测的功效都较低, 且随着<span class="math inline">\(\alpha\)</span>的增大先增后减, 可能原因在于Beta分布本身对于正态分布的趋近效果不太理想.</p>
<p>接下来我们针对对称t分布来检测功效随自由度的变化曲线:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>n=<span class="dv">30</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>m=<span class="dv">10000</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a>v=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>M=<span class="kw">length</span>(v)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>power=<span class="kw">numeric</span>(M)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>cv=<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a>sk=<span class="cf">function</span>(x){</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a>  xbar=<span class="kw">mean</span>(x)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a>  m3=<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a>  m2=<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a>  <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a>}</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a>sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>  sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true"></a>    x=<span class="kw">rt</span>(n,v[i])</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true"></a>    sktests[j]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true"></a>  }</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true"></a>  power[i]=<span class="kw">mean</span>(sktests)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true"></a>}</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true"></a><span class="kw">plot</span>(v,power)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true"></a><span class="kw">lines</span>(v,power,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过图像可以看出, 对于t分布, 检测的功效是逐渐减小的, 这是合理的, 因为当自由度逐渐增大时, t分布是几乎近似于正态分布的, 这也就是说, 检验的功效会逐渐接近0.05.</p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16.Repeat the simulation,but also compute the F test of equal variance,at significance level <span class="math inline">\(\hat\alpha=0.055\)</span>.Compute the power of the Count Five test and F test for small,medium,and large sample sizes.(Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-6.8" class="section level2">
<h2>Answer 6.8</h2>
<p>我们先给出两种检测方法所需要的函数以及用于比较两种方法的功效的检测函数:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co">#Count Five Test</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a><span class="co">#F Test</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a>Ftest=<span class="cf">function</span>(x,y,n){</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true"></a>  F=<span class="kw">var</span>(y)<span class="op">/</span><span class="kw">var</span>(x)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(F<span class="op">&lt;</span><span class="kw">qf</span>(<span class="fl">0.055</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)<span class="op">||</span>F<span class="op">&gt;</span><span class="kw">qf</span>(<span class="dv">1</span><span class="fl">-0.055</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true"></a>}</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true"></a><span class="co">#Paired-t Test</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true"></a>Ttest=<span class="cf">function</span>(x,n){</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true"></a>  T=<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">mean</span>(x)<span class="op">/</span><span class="kw">sd</span>(x))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(T<span class="op">&gt;</span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.055</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true"></a>}</span></code></pre></div>
<p>我们取<span class="math inline">\(n=20,200,2000\)</span>分别对应小样本, 中样本, 大样本：</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>sigma1=<span class="dv">1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>sigma2=<span class="fl">1.5</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>m=<span class="dv">10000</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a><span class="co">#Small sizes</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>power1=power2=<span class="kw">numeric</span>(m)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>  x=<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,sigma1)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>  y=<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,sigma2)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>  power1[i]=<span class="kw">count5test</span>(x,y)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>  power2[i]=<span class="kw">Ftest</span>(x,y,<span class="dv">20</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>}</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(power1),<span class="kw">mean</span>(power2)))</span></code></pre></div>
<pre><code>## [1] 0.3173 0.4259</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>power=power1<span class="op">-</span>power2</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">Ttest</span>(power,m))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="co">#Medium sizes</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a>power1=power2=<span class="kw">numeric</span>(m)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a>  x=<span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">0</span>,sigma1)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a>  y=<span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">0</span>,sigma2)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>  power1[i]=<span class="kw">count5test</span>(x,y)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a>  power2[i]=<span class="kw">Ftest</span>(x,y,<span class="dv">200</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a>}</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(power1),<span class="kw">mean</span>(power2)))</span></code></pre></div>
<pre><code>## [1] 0.9473 0.9999</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a>power=power1<span class="op">-</span>power2</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">Ttest</span>(power,m))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="co">#Large sizes</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>power1=power2=<span class="kw">numeric</span>(m)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a>  x=<span class="kw">rnorm</span>(<span class="dv">2000</span>,<span class="dv">0</span>,sigma1)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a>  y=<span class="kw">rnorm</span>(<span class="dv">2000</span>,<span class="dv">0</span>,sigma2)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a>  power1[i]=<span class="kw">count5test</span>(x,y)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a>  power2[i]=<span class="kw">Ftest</span>(x,y,<span class="dv">2000</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(power1),<span class="kw">mean</span>(power2)))</span></code></pre></div>
<pre><code>## [1] 0.9991 1.0000</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a>power=power1<span class="op">-</span>power2</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">Ttest</span>(power,m))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>可以看到, 在小样本情况下, 两种检验的功效都不算高, F检验的功效更为好一点, 而在中样本以及大样本情况下, 二者的功效已经接近于1, 说明在样本量越大的情况下检验功效越好, 在大样本情况下, 就算两种检验的功效已经足够接近, 但我们通过成对t检验仍然能检测出二者的检验功效是不同的.</p>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Example 6.8 and 6.10 for Mardia’s multivariate skewness test.Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E\left[(X-\mu)^T\Sigma^{-1}(Y-\mu)\right]^3.\]</span> Under normality,<span class="math inline">\(\beta_{1,d}=0.\)</span>The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{X})^T\hat\Sigma^{-1}(X_j-\bar{X}))^3,\]</span> where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance.Large values of <span class="math inline">\(b_{1,d}\)</span> are significant.The asymptotic of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-6.c" class="section level2">
<h2>Answer 6.C</h2>
<p>先来模拟Example 6.8.我们选取从二元正态分布<span class="math inline">\(N_2(0,0,1,1,0)\)</span>中生成随机数, 其中检测水平为0.05.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a>skm=<span class="cf">function</span>(x,sigma,n){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a>  xbar=<span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="kw">colMeans</span>(x),n),<span class="dt">nrow=</span>n,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a>  sum=<span class="kw">sum</span>(((x<span class="op">-</span>xbar)<span class="op">%*%</span><span class="kw">solve</span>(sigma)<span class="op">%*%</span><span class="kw">t</span>(x<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a>  <span class="kw">return</span>(sum<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a>}</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a>n=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>cv=<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">4</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a>p.reject=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a>  sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true"></a>    sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true"></a>    x=<span class="kw">mvrnorm</span>(n[i],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true"></a>    S=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">var</span>(x[,<span class="dv">1</span>]),<span class="dv">0</span>,<span class="dv">0</span>,<span class="kw">var</span>(x[,<span class="dv">2</span>])),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true"></a>    sigma.hat=(n[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>S<span class="op">/</span>n[i]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true"></a>    b=<span class="kw">skm</span>(x,sigma.hat,n[i])</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true"></a>    sktests[j]=<span class="kw">as.integer</span>(n[i]<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>cv)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true"></a>  }</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true"></a>  p.reject[i]=<span class="kw">mean</span>(sktests)  </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true"></a>}</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true"></a><span class="kw">print</span>(p.reject)</span></code></pre></div>
<pre><code>## [1] 0.026 0.040 0.058 0.053 0.049 0.056</code></pre>
<p>我们通过选取了不同的样本容量<span class="math inline">\(n\)</span>的值, 计算出了这些情况下的第一类错误. 从结果可以看出, 随着样本量的增大, 我们所得到的第一类错误的概率逐渐接近0.05, 这是合理的.</p>
<p>接下来我们进行模拟Example 6.10. 我们选取从以下分布中选取随机数： <span class="math display">\[(1-\epsilon)N_2(0,0,1,1,0)+\epsilon N_2(0,0,100,100,0)\]</span> 我们模拟出检测功效随<span class="math inline">\(\epsilon\)</span>的变化曲线:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a>n=<span class="dv">20</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>sigma1=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a>sigma2=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>epsilon=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a>N=<span class="kw">length</span>(epsilon)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>pwr=<span class="kw">numeric</span>(N)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a>cv=<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">4</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true"></a>  e=epsilon[j]</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true"></a>  sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true"></a>    x=<span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">40</span>),<span class="dt">nrow=</span><span class="dv">20</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true"></a>    <span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;=</span><span class="dv">1</span><span class="op">-</span>e) x[k,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma1)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true"></a>    <span class="cf">else</span> x[k,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma2)}</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true"></a>    S=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">var</span>(x[,<span class="dv">1</span>]),<span class="dv">0</span>,<span class="dv">0</span>,<span class="kw">var</span>(x[,<span class="dv">2</span>])),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true"></a>    sigma.hat=(n<span class="dv">-1</span>)<span class="op">*</span>S<span class="op">/</span>n</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true"></a>    b=<span class="kw">skm</span>(x,sigma.hat,n)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true"></a>    sktests[i]=<span class="kw">as.integer</span>(n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>cv)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true"></a>  }</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true"></a>  pwr[j]=<span class="kw">mean</span>(sktests)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true"></a>}</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true"></a><span class="kw">plot</span>(epsilon,pwr)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true"></a><span class="kw">lines</span>(epsilon,pwr,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过图像不难发现结果是合理的, 且与一元情况下的结果是类似的.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>(3)What information is needed to test your hypothesis?</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>(1)记两种方法的检测功效分别为<span class="math inline">\(pwr1\)</span>和<span class="math inline">\(pwr2\)</span>, 那么我们的问题假设为: <span class="math display">\[H_0:pwr1=pwr2;H_1:pwr1\neq pwr2.\]</span></p>
<p>(2)除了两样本t检验其余检验方法皆可, 因为两样本t检验要求两个样本之间是独立的, 而很明显该问题中是不独立的.</p>
<p>(3)以成对t检验为例, 我们需要知道：</p>
<p>(3.a)在m次重复实验下, 两种方法所进行的每次假设检验的结果(1代表拒绝0代表接受).</p>
<p>(3.b)每次试验下我们所生成的随机数的样本容量.</p>
<p>具体的操作方法在Question 6.8中已有相关实践.</p>
</div>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-7.1" class="section level2">
<h2>Answer 7.1</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a>b.cor=<span class="cf">function</span>(x,i)<span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a>n=<span class="kw">nrow</span>(law)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a>theta.hat=<span class="kw">b.cor</span>(law,<span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a>theta.jack=<span class="kw">numeric</span>(n)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true"></a>  theta.jack[i]=<span class="kw">b.cor</span>(law,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true"></a>}</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true"></a>bias.jack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true"></a>se.jack=<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##   original  bias.jack    se.jack 
##  0.7763745 -0.0064736  0.1425186</code></pre>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4.Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal,basic,percentile,and BCa methods.Compare the intervals and explain why they may difer.</p>
</div>
<div id="answer-7.5" class="section level2">
<h2>Answer 7.5</h2>
<p>根据极大似然方法, 我们可以求得<span class="math inline">\(\hat\lambda=\frac{1}{\bar{X}}\)</span>, 从而在本题中所需要估计的量<span class="math inline">\(\frac{1}{\hat\lambda}=\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a>theta.boot=<span class="cf">function</span>(dat,ind){</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a>  x=dat[ind,<span class="dv">1</span>]</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a>  <span class="kw">mean</span>(x)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a>}</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true"></a>x=<span class="kw">as.matrix</span>(aircondit<span class="op">$</span>hours)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true"></a>boot.obj=<span class="kw">boot</span>(x,<span class="dt">statistic =</span> theta.boot,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(<span class="dt">boot.out =</span> boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 31.4, 182.9 )   ( 25.5, 170.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.1, 190.6 )   ( 54.3, 223.7 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>可以看到四种方法所得到的置信区间存在一定的差异, 根据课本对几种方法的介绍, 我们可分析差异的原因可能为模拟结果不太满足大样本性质, 从而导致我们在运用以上几种大样本性质估计置信区间的方法时会存在一定的偏差, 以及各种方法所假定的一些其他条件的不相合也会促使差异的产生.</p>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7.Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-7.8" class="section level2">
<h2>Answer 7.8</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>n=<span class="kw">nrow</span>(scor)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a>lambda.hat=<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a>theta.hat=lambda.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda.hat)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a>theta.jack=<span class="kw">numeric</span>(n)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a>  x=scor[<span class="op">-</span>i,]</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a>  lambda=<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a>  theta.jack[i]=lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true"></a>bias.jack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true"></a>se.jack=<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
## 0.6191150 0.0010691 0.0495524</code></pre>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>In Example 7.18,leave-one-out (n-fold) cross validation was used to select the best fitting model.Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-7.11" class="section level2">
<h2>Answer 7.11</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a>n=<span class="kw">length</span>(magnetic)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a>e1=e2=e3=e4=<span class="kw">c</span>(<span class="ot">NULL</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a>    y=magnetic[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a>    x=chemical[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true"></a>    </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true"></a>    J1=<span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true"></a>    yhat1=J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true"></a>    yhat2=J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[j]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true"></a>    e1=<span class="kw">c</span>(e1,magnetic[i]<span class="op">-</span>yhat1,magnetic[j]<span class="op">-</span>yhat2)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true"></a>    </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true"></a>    J2=<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true"></a>    yhat3=<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true"></a>    yhat4=<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true"></a>    e2=<span class="kw">c</span>(e2,magnetic[i]<span class="op">-</span>yhat3,magnetic[j]<span class="op">-</span>yhat4)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true"></a>    </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true"></a>    logyhat5 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true"></a>    yhat5 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat5)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true"></a>    logyhat6 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true"></a>    yhat6 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat6)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true"></a>    e3=<span class="kw">c</span>(e3,magnetic[i]<span class="op">-</span>yhat5,magnetic[j]<span class="op">-</span>yhat6)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true"></a>    </span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true"></a>    logyhat7 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i])</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true"></a>    yhat7 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat7)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true"></a>    logyhat8 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j])</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true"></a>    yhat8 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat8)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true"></a>    e4=<span class="kw">c</span>(e4,magnetic[i]<span class="op">-</span>yhat7,magnetic[j]<span class="op">-</span>yhat8)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true"></a>  }</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true"></a>}</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>从结果可以看出, Model 2是最佳的模型.</p>
</div>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-8.3" class="section level2">
<h2>Answer 8.3</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>maxout=<span class="cf">function</span>(x,y){</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a>  X=x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a>  Y=y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true"></a>  outx=<span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true"></a>  outy=<span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy)))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true"></a>}</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true"></a>n1=<span class="dv">20</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true"></a>n2=<span class="dv">30</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true"></a>mu1=mu2=<span class="dv">0</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true"></a>sigma1=sigma2=<span class="dv">1</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true"></a>p=<span class="kw">numeric</span>(m)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true"></a>  x=<span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true"></a>  y=<span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true"></a>  z=<span class="kw">c</span>(x,y)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true"></a>  R=<span class="dv">999</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true"></a>  reps=<span class="kw">numeric</span>(R)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true"></a>  t0=<span class="kw">maxout</span>(x,y)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true"></a>    k=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2),<span class="dt">size=</span>n1,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true"></a>    x1=z[k]</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true"></a>    y1=z[<span class="op">-</span>k]</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true"></a>    reps[j]=<span class="kw">maxout</span>(x1,y1)</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true"></a>  }</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true"></a>  p[i]=<span class="kw">mean</span>(<span class="kw">c</span>(t0,reps)<span class="op">&gt;=</span>t0)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true"></a>}</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">mean</span>(p))</span></code></pre></div>
<pre><code>## [1] 0.590954</code></pre>
</div>
<div id="question-discussion" class="section level2">
<h2>Question Discussion</h2>
<p>Design experiments for evaluating the performance of the NN,energy,and ball methods in various situations.</p>
<p>(a)Unequal variances and equal expectations</p>
<p>(b)Unequal variances and unequal expectations</p>
<p>(c)Non-normal distributions:t distribution with 1 df (heavy-tailed distribution),bimodel distribution (mixture of two normal distributions)</p>
<p>(d)Unbalanced samples(say,1 case versus 10 controls)</p>
<p>Note:The parameters should be chosen such that the powers are distinguishable (say,range from 0.3 to 0.8).</p>
</div>
<div id="answer-discussion" class="section level2">
<h2>Answer Discussion</h2>
<p>首先我们给出该问题中所需要的一些函数:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="kw">library</span>(RANN)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a>Tn=<span class="cf">function</span>(z,ix,sizes,k){</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>  n1=sizes[<span class="dv">1</span>]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>  n2=sizes[<span class="dv">2</span>]</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>  n=n1<span class="op">+</span>n2</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a>  z=z[ix,]</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>  NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z,<span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a>  block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a>  block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a>  i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>  i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a>  (i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a>}</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a><span class="kw">library</span>(energy)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<p>对于实验1, 我们选取的参数为<span class="math inline">\(\mu_1=\mu_2=0,\sigma_1=1,\sigma_2=1.5\)</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a>k=<span class="dv">3</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a>p=<span class="dv">2</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true"></a>n1=n2=<span class="dv">50</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true"></a>R=<span class="dv">999</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true"></a>n=n1<span class="op">+</span>n2</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true"></a>eqdist.nn=<span class="cf">function</span>(z,sizes,k){</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true"></a>  boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>sizes,<span class="dt">k=</span>k)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true"></a>  ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true"></a>  p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true"></a>}</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true"></a>p.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true"></a>  y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true"></a>}</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true"></a>alpha=<span class="fl">0.1</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true"></a>pow=<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.478 0.585 0.937</code></pre>
<p>对于实验2, 我们选取的参数为<span class="math inline">\(\mu_1=0,\mu_2=0.3,\sigma_1=1.5,\sigma_2=1\)</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a>p.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true"></a>  y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="fl">0.3</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true"></a>}</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true"></a>alpha=<span class="fl">0.1</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true"></a>pow=<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.593 0.838 0.967</code></pre>
<p>对于实验3, 我们选取的<span class="math inline">\(t\)</span>分布自由度为1, 混合正态分布参数为<span class="math inline">\(\mu_1=0,\mu_2=0.3,\sigma_1=\sigma_2=1\)</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a>p.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a>  x=<span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2,<span class="fl">0.3</span>,<span class="dv">1</span>))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true"></a>}</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true"></a>alpha=<span class="fl">0.1</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true"></a>pow=<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.92 1.00 1.00</code></pre>
<p>对于实验4, 我们选取的两个样本量为10和100</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a>k=<span class="dv">3</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a>p=<span class="dv">2</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a>n1=<span class="dv">10</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true"></a>n2=<span class="dv">100</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true"></a>R=<span class="dv">999</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true"></a>n=n1<span class="op">+</span>n2</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true"></a>p.values=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true"></a>  y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true"></a>}</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true"></a>alpha=<span class="fl">0.1</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true"></a>pow=<span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.413 0.475 0.349</code></pre>
</div>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Inplement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2).For the increment,simulate from a normal distribution.Compare the chains generated when different variances are used for the proposal distribution.Also,compute the acceptance rates of each chain.</p>
</div>
<div id="answer-9.4" class="section level2">
<h2>Answer 9.4</h2>
<p>首先我们给出该算法对应的函数:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>rw.Metropolis=<span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true"></a>  f=<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true"></a>  x=<span class="kw">numeric</span>(N)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true"></a>  x[<span class="dv">1</span>]=x0</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true"></a>  u=<span class="kw">runif</span>(N)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true"></a>  k=<span class="dv">0</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true"></a>   y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true"></a>   <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="kw">f</span>(y)<span class="op">/</span><span class="kw">f</span>(x[i<span class="dv">-1</span>])) x[i]=y</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true"></a>   <span class="cf">else</span>{</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true"></a>     x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true"></a>     k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true"></a>   }</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true"></a>  }</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>接下来我们用四个不同的标准差(0.05,0.5,2,16)来生成Marcov链:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a>N=<span class="dv">2000</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a>x0=<span class="dv">25</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true"></a>rw1=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true"></a>rw2=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true"></a>rw3=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true"></a>rw4=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZjpmZrZmtrZmtv+QOgCQkGaQ2/+2ZgC2Zma2tma225C2///bkDrb////tmb/25D//7b//9v///+iW2fsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIg0lEQVR4nO2da4OiNhSGmemO22ovY7Xtsuj4//9luZMA4U3g5IK+z4cZ0XASn01CiGfc7EEWyWI3IHUoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBAWFC2G2IJkg3nDwoCUBAgriD7ER4NCgIEFqRfHByuEdFgDwJQEICCALEFJW8ouqDUDUVeKKZviIIAsW81KAiEoyAUjoJAOAoC4bQxlqAtr4Juh08crpKSZcPjxPAi6H4a7trff4BwgyC3PeBA+OlBRXasfln2oKxZDjlukgfC0xC7n779pKBFrm+XdYISU+Rvks6zo5UgbZfxlQSV/eeXdYKSMuTzMv91zpwE9UfuVfkj6qb96EnlQKQyETwJyss3WfeeHK6D2sX0IOUVBOXlJex++njYCXq8nKCv87H+Wa6FrATVT7ySoPupmZyv335aC1Jeen5BTQ8quX6sFJSOIk9zUKulvGtdKygVQ96uYs0g+zq7C0prPR19w2z2RQoC4SjIQlAihtIU9Ehn95WCAOkLqh/EG3GJC1K2iWTrt2YXgmKuHPcgKOrSOm1BWRbdUMKCtA86urlIthUWJC0oGwmK0YtS2JNeKtovqmMNs2R70OTSFcnQ7gSFNrQ/QYENbRD0z/xWmFS940m5n5I21LoCR0H3P7vj28GwVyhYr24jzk2Zq6DT26V+cDVtNkvWq8vo1tZbqnXHdYh9nbOPqvtUP73XOycj9CzkPgcV2dsfWduPAtQ7ObETFMjTikm66USh6p2cOAgKYshdUF71oG0TkEu9kxM7Q4HGmqug+6nqPuXPY6B6Z04Neuvh6SrmlP7iyOg+3zN+1kGO6S+OzOwStdI2BDVWtr6geSW9Jv3FAfU+XxfkQZGXe7Ft6S+4Ka2YQZDDLopzZeIFH1vTXyza0gma2breEne2LvGCFZvSXyzaMpjYqaCN6S+wLWq+XvuEL0Pp7gctnTxOaJwKEmtuunvSy2HUgMq+9dCjtrVTqUq8YI3PhaIep10AqXOS6EjzNEl7XSjqgXQd4lORx8u8t4XiKNIOBXleKI5DzQoSG8PiBR/+F4qjUJoNaUO7XCiOQukyBkEijna5UByFMgiS6US7XCiOQo0//BhWjhLRxQsGDzf2oP5lnkB08YJRws3VIGPoqQVJTNPPLGg6+taEES8YJZypFgoCtWw3REEohHjBKOGM1VAQqGapHit7LyzIbvxREIpgXZVtwSjhzPUYK2pu+HEA65psCy5H8fXpjLnC5abMP68eWtfk1K7Q4cz1uAjq82rU56xrcm5byHDmeoyGlgSpO5TWNa1oXbhw5noMgtSRPnxk9JqCRttp6vPtzqyW0zfqWc8uaOZTIeVBpnek9jnNKgX1hrqd/pcXNB1PnayhE72QIG0YqQ/0FzP1U311Gnp+QY8lQQ/diD7a3Bq6X0Gj99+Pp/61qSDVoHUlwm2WDQcq60dRPwvPFHjoPcevoK9z0yZjLnUsQQ/NglZC/e1bUN79pUJh+pOF4IL0C9iMIO23Z0F9dkepqvpe6Y3hZNDmF4ttjq6wdXyHtnT5QSWF/+QFS9TRE1tQkj1Iu7Tbl/Y1B7VdKI05qKvTRVB/knjBmu7/RTD0nziC+roTEBQ6nFvdLpUHFqTc++wET4KCJZJ7x9MkHS6R3DceL/OBEsk943WhuJRIvht8CLJIJHcLalkuSrFVxXEiuVvQpxOEE8ndgj6fIOGgFCRTjoJSLLayuGxQCpIpR0EpFltZ/PWgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAHlBRbb0tdRN+sOHWm75hCVuv/6QDjlBXFBRtqwwt+72/TIqB05Y4H6qPzqQDDlFWlDz2dnV+NXdXWpaXw6dYKZok0kFQ84gLeh2qD4YMn+umH+MyqETjBTZsVEjF3IOcUF1fzelMJb/rr+V88VRKYdOWKI5SzTkBGlBzdA3TgD3U5Wcdj0O5cAJy5VVDmRDTggsqC30/kNOkGzICaGHWFPo8Ck4xERDTgg9STeFvl9EZlRVkFDICYEv803byzcmck2uBcmGnBB6oVg3u5xRRVZ17VVMMuQE+VuNfHmZf826PNCuHDhhgXaISYacwJtVAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQX5Dy5YMWaAm+3cGQCCxPfEFOaHkb/UGfCOyBfQnSMn+GA6FkslkiCrod6rSVZohdy9Hy99vldvirHC7H6qX22exTO0XJHRsOcj+jqyaeoPr9FdlnLehavs0iqwSVQyavEsSrN171jup702qV1XyjZR8OB10isA/iCerGRSWo6QzXSlCV8Nz8+Lz/fun6SXeOmr/aH/SJwD6IJ6j9S4taUCOreGsSMYcf9YUKCmpf8zMRRZyD6m/vbuagfF5QnmXv/6k9yDDEmtcOLssFayJfxa7VADH1oP5gmIPmJ+kaT9f6yIJKO8MclI8E1doKdYjNX+b7RGAfLYw4SbcJu6Or2KgHlYvk4+ik6UKxTwT2QMQeVNSjZlgHvf/bJsmrc9Db5aol9LYJvl/nj4eS7TteLwmS0kra54J4NWkIqvvM/eRprbeJNATVw83XINlGIoLShYIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/gcG+QMPMLITAAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZjpmZrZmtrZmtv+QOgCQkGaQ2/+2ZgC2Zma2tma225C2/7a2///bkDrb////tmb/25D//7b//9v////umPskAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHpklEQVR4nO2d6YKiOBhFYy09o7PYo7MUjTbv/5YTCEtWLpEgEe75YSkmFzkVAlqflKjIKGLtF5A7FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAMYLup6O8LYUQb19LvZ7siBZUvP+o750Xe0WZESuoVdNo2gWxgm6fjaByNztZ4hEkXoZlBNXJH1U3Xc+MW5VFBFWNo8NFHsgCfihoYlz+np4syNq1p+/hq7GQoEIqUJN04Ci2c0GFnH/up3qWpiAfP78fm1t5iKcgH90bjOv7DwryoUaQ5PpBQV46LfJsiIK8FOoYJscSBc1ZLwWBOAoCcRQE4igIxFEQiKMgEEdBII6CQBwFOSn8wCwqjoJAHAWBOAoCcRQE4igIxFEQiKMgELdXQRMqzCgIVJhREKoPUrc7FgQqzCiII2iEyRVmexVUTa0w27GgaXEU5KTwA7OoOAoCcXsVpI5iCp4H+QhWvVhxuxUkDX1MiduvIHkGNP49qN0LmhZHQSCOgkAcBYE4CgJxFATiti3o7znfRt2qoPsf3ePb56yv625W0Olwae5cZ14zYKuC5HuI+qPU26cAbyVCKTv4PKgUh99FO47mrneTgtpBlGS9mxRU1CNo9vUUNivofqqHj7wN/bkiKm57gngUAw15HhTRkGfSjzWMiaMgEEdBII6CQBwFgTgKAnF7FcQqVwCrXAGsUQSEq1z38IHZBF57BImRR5O7jTO7ynVFb/alJZc6zE+tcnVjIy5/ucQAtFe/9nnQwoLiFW5FUNPkQUGj3V5EkEBrpCAwjKYJ8ob0C729tXOQcCNvx6kNY+J8u9OCgozfSmAF/fgVryIotB3VyDZqWUaw/lN/zrgrDPmvLqh/tr4zGOj7bk5Q/05E30iPqj0JEsN0KIQuqN8Qz4w+tNHe1umC+qerbgVWYP+o0jrmKWh4XViQMa5cQcZi7Yce9IqCzE3yCxpk2j2tHDvVDDAF6TZ8ffIVZG6X0dbpqT8XEGRbrHIVZK3euylYkLaNvRZLkBMOBFmNVxNkxYXN+ESZHbzdfYLUfN3J0PMr40fGgrQDlF+QpUTbM0Jih7ZdrCGoe87tqHWK2+5FBGlH4kpf4N9NKv0URzW2d8ARQcMjn9FXFWSd/VTGOR0WNLQW2jj1iTF/I+4LnbxFqegFmZv8iCCtXxUnyOhZeR5VeQrSR4b1tEfQ0M8aAQ8Jctb4coKMEGvnHBK6BRME2RNbXoLc5ZGCjJ7mHUO+I8ia98KxcFNiG86LcwXFR2s9NUGmOUMDBZlPoOTlBU2u7vAsf1zMEOG/n5ugKdUdnuXzBZlxZra7EHaavKqIlzX5b/Oe5YsKeqTT5FVNbVhFXMPMs3w3gjiCRsjnv2TOt73UYT5Q3SF64uIeJV9BT44LriZrQf3/YUsT9wgUBKCgxaEgAAUBNn4Um89qgl6GlQTFhU59j7BGswebpw2loDTtKCjHZg82TxtKQWnaUVCOzR5snjaUgtK0256gLUFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA6QWVYuyy1EONUd9uvMMYt1++Ukc6JBdU1vVD4Vd3+3ax2oEOI9xPTSFgykiX1ILU36WvwUt3d8WNfTvUIUzZliMnjPSQWpAq8iyChdTFh9UOdQhSiqNSky7SR3JBzXgPFcHK3+uvcr44au1QhzFUr6SRDqkFqV0/OAHcT3V57PU4tAMdxldWO0gb6fBkQW2jt690gtJGOjx7F1ONPs8Jd7GkkQ7PnqRVo2+XJDOqLihRpMOTD/PqtcsNS3JMbgSljXR49oli87LljJrkrK49iqWMdEj/VqMYP82/ymPy2WgHOozQ7mIpIx34ZhVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAmQjKHj10wCqBLi6faoK4MXIRlAkbQlw+f5D3l3S0IsKakuAVSVQolIpP+sLqncScW53sasQh78Ol9vnnychjvVT7VJh7IBdCXBfQ74cqwtqCsRKcW4EXeVWl6IWdLhURT1I6tFRV0gVckGjsv+2QS2ofPvvJIL/9DUJqwvq6gxrQaqa7loLquue1c35/tulK7Sz+zUOf37f9BzUzraNICWrPKh6zOGmmXO8gg4J61n9rC5IDoB+Dir8ggo5I//rH0Hq2yz2cylZX1CN3KvCI6h/4JuDjK/7LEEegqSdYQ4qLEFKhXcXU4e+be9iXd2udRSzRtD9ZB+r2m/6yBPFsSuDzmd1Qc2/oZCS+vOgt3/aWnl9DjpcrlZdbztsSrH1w7zLontMNFkJasZM8Hr565CVoGaHsWfjlclLUIZQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/JVfAa1GiWI8AAAAASUVORK5CYII=" /><!-- --></p>
<p>从图中可以看出,<span class="math inline">\(\sigma=0.05\)</span>时接受率很高, 几乎所有的点都被接受, 增量很小并且链就像真正的随机游走, 说明尚未收敛. <span class="math inline">\(\sigma=0.5\)</span>的情况下链收敛，但收敛速度相比后面两种情况要慢一点. <span class="math inline">\(\sigma=2\)</span>的情况下链的生成良好并且收敛到目标分布. <span class="math inline">\(\sigma=16\)</span>的情况下拒绝率太高, 效率较低.最后给出四个链的接受率：</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9825 0.8300 0.5210 0.1085</code></pre>
</div>
<div id="question-discussion-1" class="section level2">
<h2>Question Discussion</h2>
<p>For Exercise 9.4,use the Gelman-Rubin method to monitor convergence of the chain,and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span>.</p>
</div>
<div id="answer-discussion-1" class="section level2">
<h2>Answer Discussion</h2>
<p>我们选取标准差<span class="math inline">\(\sigma=0.8\)</span>生成四条链:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a>Gelman.Rubin=<span class="cf">function</span>(psi){</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>  psi=<span class="kw">as.matrix</span>(psi)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a>  n=<span class="kw">ncol</span>(psi)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>  k=<span class="kw">nrow</span>(psi)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true"></a>  psi.means=<span class="kw">rowMeans</span>(psi)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true"></a>  B=n<span class="op">*</span><span class="kw">var</span>(psi.means)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true"></a>  psi.w=<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true"></a>  W=<span class="kw">mean</span>(psi.w)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true"></a>  v.hat=W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">+</span>(B<span class="op">/</span>n)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true"></a>  r.hat=v.hat<span class="op">/</span>W</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true"></a>}</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true"></a>laplace.chain=<span class="cf">function</span>(sigma,N,X1){</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true"></a>  f=<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true"></a>  x=<span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true"></a>  x[<span class="dv">1</span>]=X1</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true"></a>  u=<span class="kw">runif</span>(N)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true"></a>    xt=x[i<span class="dv">-1</span>]</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true"></a>    y=<span class="kw">rnorm</span>(<span class="dv">1</span>,xt,sigma)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true"></a>    r1=<span class="kw">f</span>(y)<span class="op">*</span><span class="kw">dnorm</span>(xt,y,sigma)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true"></a>    r2=<span class="kw">f</span>(xt)<span class="op">*</span><span class="kw">dnorm</span>(y,xt,sigma)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true"></a>    r=r1<span class="op">/</span>r2</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>r)x[i]=y</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true"></a>    <span class="cf">else</span> x[i]=xt</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true"></a>  }</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true"></a>  <span class="kw">return</span>(x)</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true"></a>}</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true"></a>sigma=<span class="fl">0.8</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true"></a>k=<span class="dv">4</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true"></a>n=<span class="dv">15000</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true"></a>b=<span class="dv">1000</span></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true"></a>x0=<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true"></a>X=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true"></a>  X[i,]=<span class="kw">laplace.chain</span>(sigma,n,x0[i])</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true"></a>}</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true"></a>psi=<span class="kw">t</span>(<span class="kw">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)){</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true"></a>  psi[i,]=psi[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true"></a>}</span></code></pre></div>
<p>作出四条链对应的参数图:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true"></a>  <span class="kw">plot</span>(psi[i,(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span>i,<span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>最后给出<span class="math inline">\(\hat R\)</span>的变化曲线:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a>rhat=<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true"></a>  rhat[j]=<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true"></a>}</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)\]</span> and <span class="math display">\[S_k(a)=P\left(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\right),\]</span> for <span class="math inline">\(k=4:25,100,500,1000\)</span>,where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom.(These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely.)</p>
</div>
<div id="answer-11.4" class="section level2">
<h2>Answer 11.4</h2>
<p>首先根据大致图像可以看出各种情况下的根都很小, 大致在区间(0,4)内, 而由于函数uniroot仅能返回一个根, 所以我们对求解范围进行一下控制:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a>k=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a>n=<span class="kw">length</span>(k)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true"></a>res=<span class="kw">numeric</span>(n)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true"></a>  f=<span class="cf">function</span>(x) <span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i])</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true"></a>  res0=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">min</span>(<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.01</span>,<span class="dv">4</span>)))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true"></a>  res[i]=<span class="kw">unlist</span>(res0)[<span class="dv">1</span>]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true"></a>}</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true"></a>res=<span class="kw">rbind</span>(k,res)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true"></a><span class="kw">print</span>(res)</span></code></pre></div>
<pre><code>##         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]      [,7]      [,8]
## k   4.000000 5.000000 6.000000 7.000000 8.000000 9.000000 10.000000 11.000000
## res 1.492073 1.533555 1.562745 1.584429 1.601184 1.614516  1.625389  1.634418
##          [,9]     [,10]     [,11]     [,12]     [,13]     [,14]     [,15]
## k   12.000000 13.000000 14.000000 15.000000 16.000000 17.000000 18.000000
## res  1.642026  1.648552  1.654175  1.659099  1.663454  1.667308  1.670749
##         [,16]     [,17]     [,18]     [,19]     [,20]     [,21]     [,22]
## k   19.000000 20.000000 21.000000 22.000000 23.000000 24.000000 25.000000
## res  1.673842  1.676635  1.679172  1.681485  1.683604  1.685553  1.687351
##        [,23]     [,24]       [,25]
## k   100.0000 500.00000 1000.000000
## res   1.7206   1.72975    1.730898</code></pre>
</div>
<div id="question-discussion-2" class="section level2">
<h2>Question Discussion</h2>
<p>A-B-O blood type problem</p>
<p>Observed data: <span class="math inline">\(n_A.=n_{AA}+n_{AO}=444\)</span> (A-type), <span class="math inline">\(n_{B.}=n_{BB}+n_{BO}=132\)</span> (B-type), <span class="math inline">\(n_{OO}=361\)</span> (O-type), <span class="math inline">\(n_{AB}=63\)</span> (AB-type).</p>
<p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>(consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps,calculate the corresponding log-maximum likelihood values (for observed data),are they increasing?</p>
</div>
<div id="answer-discussion-2" class="section level2">
<h2>Answer Discussion</h2>
<p>首先我们写出对数似然函数: <span class="math display">\[L=n_{AA}log(p^2)+n_{BB}log(q^2)+n_{OO}log(r^2)+n_{AO}log(2pr)+n_{BO}log(2qr)+n_{AB}log(2pq)\]</span> 接着我们进行E步算法, 注意到: <span class="math display">\[n_{AA}|n_{A.},p,r\sim B(n_{A.},\frac{p^2}{p^2+2pr})\]</span> <span class="math display">\[n_{BB}|n_{B.},q,r\sim B(n_{B.},\frac{q^2}{q^2+2qr})\]</span> <span class="math display">\[n_{AO}|n_{A.},p,r\sim B(n_{A.},\frac{2pr}{p^2+2pr})\]</span> <span class="math display">\[n_{BO}|n_{B.},q,r\sim B(n_{B.},\frac{2qr}{q^2+2qr})\]</span> 从而我们可以得到第<span class="math inline">\(t+1\)</span>步与第<span class="math inline">\(t\)</span>步之间的关系: <span class="math display">\[E(L^{(t+1)}|n_{A.}^{(t)},n_{B.}^{(t)},n_{OO}^{(t)},n_{AB}^{(t)})=n_{AA}^{(t)}log(p^2)+n_{BB}^{(t)}log(q^2)+n_{OO}^{(t)}log(r^2)+n_{AO}^{(t)}log(2pr)+n_{BO}^{(t)}log(2qr)+n_{AB}^{(t)}log(2pq)\]</span> 其中我们有: <span class="math display">\[n_{AA}^{(t)}=n_{A.}\cdot \frac{p_t^2}{p_t^2+2p_tr_t}\]</span> <span class="math display">\[n_{BB}^{(t)}=n_{B.}\cdot \frac{q_t^2}{q_t^2+2q_tr_t}\]</span> <span class="math display">\[n_{AO}^{(t)}=n_{A.}\cdot \frac{2p_tr_t}{p_t^2+2p_tr_t}\]</span> <span class="math display">\[n_{BB}^{(t)}=n_{B.}\cdot \frac{2q_tr_t}{q_t^2+2q_tr_t}\]</span> <span class="math display">\[n_{AB}^{(t)}=n_{AB}，n_{OO}^{(t)}=n_{OO}\]</span> 最后我们进行M步求最值, 我们对<span class="math inline">\(p,q\)</span>分别求偏导并令其值为0可以得到: <span class="math display">\[\frac{2n_{AA}^{(t)}+n_{AO}^{(t)}+n_{AB}^{(t)}}{p}-\frac{2n_{OO}^{(t)}+n_{AO}^{(t)}+n_{BO}^{(t)}}{1-p-q}=0\]</span> <span class="math display">\[\frac{2n_{BB}^{(t)}+n_{BO}^{(t)}+n_{AB}^{(t)}}{q}-\frac{2n_{OO}^{(t)}+n_{AO}^{(t)}+n_{BO}^{(t)}}{1-p-q}=0\]</span> 联立可解得: <span class="math display">\[p_{t+1}=\frac{2n_{AA}^{(t)}+n_{AO}^{(t)}+n_{AB}^{(t)}}{2n}\]</span> <span class="math display">\[q_{t+1}=\frac{2n_{BB}^{(t)}+n_{BO}^{(t)}+n_{AB}^{(t)}}{2n}\]</span> 根据概率之和等于1可以得到: <span class="math display">\[r_{t+1}=\frac{2n_{OO}^{(t)}+n_{AO}^{(t)}+n_{BO}^{(t)}}{2n}\]</span> 有了迭代关系之后我们根据代码实现EM算法:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>na=<span class="dv">444</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>nb=<span class="dv">132</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a>noo=<span class="dv">361</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a>nab=<span class="dv">63</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true"></a>n=na<span class="op">+</span>nb<span class="op">+</span>noo<span class="op">+</span>nab</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true"></a>p=q=r=L=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true"></a>p[<span class="dv">1</span>]=q[<span class="dv">1</span>]=r[<span class="dv">1</span>]=<span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">20</span>){</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true"></a>  naa=na<span class="op">*</span>(p[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">/</span>((p[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true"></a>  nao=na<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>p[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])<span class="op">/</span>((p[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true"></a>  nab=nab</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true"></a>  nbb=nb<span class="op">*</span>(q[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">/</span>((q[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true"></a>  nbo=nb<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>q[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])<span class="op">/</span>((q[i<span class="dv">-1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q[i<span class="dv">-1</span>]<span class="op">*</span>r[i<span class="dv">-1</span>])</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true"></a>  noo=noo</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true"></a>  p[i]=(<span class="dv">2</span><span class="op">*</span>naa<span class="op">+</span>nao<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true"></a>  q[i]=(<span class="dv">2</span><span class="op">*</span>nbb<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true"></a>  r[i]=(<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>nao<span class="op">+</span>nbo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true"></a>  L[i]=naa<span class="op">*</span><span class="kw">log</span>((p[i])<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nao<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>r[i])<span class="op">+</span>nbb<span class="op">*</span><span class="kw">log</span>((q[i])<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nbo<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q[i]<span class="op">*</span>r[i])<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">*</span>q[i])<span class="op">+</span>noo<span class="op">*</span><span class="kw">log</span>((r[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true"></a>}</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">cbind</span>(p,q,r,L))</span></code></pre></div>
<pre><code>##               p         q         r         L
##  [1,] 0.3333333 0.3333333 0.3333333     0.000
##  [2,] 0.3275000 0.1195000 0.5530000 -1627.919
##  [3,] 0.3042185 0.1039357 0.5918457 -1495.500
##  [4,] 0.2988902 0.1028274 0.5982824 -1475.454
##  [5,] 0.2978702 0.1027229 0.5994069 -1472.105
##  [6,] 0.2976825 0.1027090 0.5996085 -1471.514
##  [7,] 0.2976483 0.1027067 0.5996450 -1471.407
##  [8,] 0.2976420 0.1027063 0.5996516 -1471.388
##  [9,] 0.2976409 0.1027063 0.5996528 -1471.385
## [10,] 0.2976407 0.1027063 0.5996530 -1471.384
## [11,] 0.2976407 0.1027063 0.5996531 -1471.384
## [12,] 0.2976407 0.1027063 0.5996531 -1471.384
## [13,] 0.2976407 0.1027063 0.5996531 -1471.384
## [14,] 0.2976407 0.1027063 0.5996531 -1471.384
## [15,] 0.2976407 0.1027063 0.5996531 -1471.384
## [16,] 0.2976407 0.1027063 0.5996531 -1471.384
## [17,] 0.2976407 0.1027063 0.5996531 -1471.384
## [18,] 0.2976407 0.1027063 0.5996531 -1471.384
## [19,] 0.2976407 0.1027063 0.5996531 -1471.384
## [20,] 0.2976407 0.1027063 0.5996531 -1471.384</code></pre>
<p>根据结果我们可以看到, 参数都很好的收敛了, 从而可以求得参数估计值为: <span class="math display">\[\hat p=0.2976,\hat q=0.1027,\hat r=0.5997\]</span> 同时可以观察到, 随着EM算法的进行, 我们每一步的对数似然函数值的确是在逐渐增大的.</p>
</div>
<div id="question-11.1.2.3" class="section level2">
<h2>Question 11.1.2.3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
</div>
<div id="answer-11.1.2.3" class="section level2">
<h2>Answer 11.1.2.3</h2>
<p>使用lapply:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true"></a>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true"></a><span class="kw">lapply</span>(formulas,lm)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>使用循环:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a>res=<span class="kw">list</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a>  res[[i]]=<span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true"></a>}</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true"></a><span class="kw">print</span>(res)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-11.2.5.3" class="section level2">
<h2>Question 11.2.5.3</h2>
<p>The following code simulates the performance of a t-test for non-normal data.Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge:get rid of the annoymous function by using [[ directly.</p>
</div>
<div id="answer-11.2.5.3" class="section level2">
<h2>Answer 11.2.5.3</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a>  <span class="dv">100</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) <span class="kw">return</span>(x<span class="op">$</span>p.value))</span></code></pre></div>
<pre><code>##   [1] 0.178809502 0.994262402 0.064786264 0.952716251 0.306702525 0.198224877
##   [7] 0.272315768 0.283722503 0.415010770 0.151957272 0.072625558 0.249014108
##  [13] 0.773938569 0.225693023 0.840328179 0.987492066 0.316112244 0.481740992
##  [19] 0.457889571 0.565871989 0.990401857 0.257905112 0.538178810 0.764364559
##  [25] 0.845551784 0.905726387 0.086725138 0.763639767 0.088857796 0.531422351
##  [31] 0.731524606 0.195574176 0.598923896 0.702134266 0.147168770 0.552598436
##  [37] 0.117002585 0.233188724 0.127240002 0.115791872 0.317030411 0.691674119
##  [43] 0.450514119 0.315343567 0.073583503 1.000000000 0.011099981 0.580714657
##  [49] 0.591841839 0.638287091 0.283349660 0.722557025 0.408819857 0.127117578
##  [55] 0.000507563 0.841418067 0.624022112 0.650656602 0.632088219 0.578419158
##  [61] 0.052008307 0.920025002 0.646534041 0.344836350 0.751638828 0.687324041
##  [67] 0.134492519 0.490444844 0.711864108 0.020394691 0.342792908 0.960823950
##  [73] 0.111337525 0.546907007 0.773231299 0.626303636 0.298304108 0.146218612
##  [79] 0.133931753 0.814393484 0.096839576 0.974929586 0.808056754 0.346709412
##  [85] 0.308443909 0.600935588 0.984471134 0.703069949 0.678262994 0.565803030
##  [91] 0.895621651 0.723438333 0.431024548 0.061331285 0.043636182 0.359298038
##  [97] 0.372409666 0.953012247 0.503028465 0.594358009</code></pre>
<p>不使用annoymous function:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.178809502 0.994262402 0.064786264 0.952716251 0.306702525 0.198224877
##   [7] 0.272315768 0.283722503 0.415010770 0.151957272 0.072625558 0.249014108
##  [13] 0.773938569 0.225693023 0.840328179 0.987492066 0.316112244 0.481740992
##  [19] 0.457889571 0.565871989 0.990401857 0.257905112 0.538178810 0.764364559
##  [25] 0.845551784 0.905726387 0.086725138 0.763639767 0.088857796 0.531422351
##  [31] 0.731524606 0.195574176 0.598923896 0.702134266 0.147168770 0.552598436
##  [37] 0.117002585 0.233188724 0.127240002 0.115791872 0.317030411 0.691674119
##  [43] 0.450514119 0.315343567 0.073583503 1.000000000 0.011099981 0.580714657
##  [49] 0.591841839 0.638287091 0.283349660 0.722557025 0.408819857 0.127117578
##  [55] 0.000507563 0.841418067 0.624022112 0.650656602 0.632088219 0.578419158
##  [61] 0.052008307 0.920025002 0.646534041 0.344836350 0.751638828 0.687324041
##  [67] 0.134492519 0.490444844 0.711864108 0.020394691 0.342792908 0.960823950
##  [73] 0.111337525 0.546907007 0.773231299 0.626303636 0.298304108 0.146218612
##  [79] 0.133931753 0.814393484 0.096839576 0.974929586 0.808056754 0.346709412
##  [85] 0.308443909 0.600935588 0.984471134 0.703069949 0.678262994 0.565803030
##  [91] 0.895621651 0.723438333 0.431024548 0.061331285 0.043636182 0.359298038
##  [97] 0.372409666 0.953012247 0.503028465 0.594358009</code></pre>
</div>
<div id="question-11.2.5.6" class="section level2">
<h2>Question 11.2.5.6</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-11.2.5.6" class="section level2">
<h2>Answer 11.2.5.6</h2>
<p>我们写出大致框架:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a>Mv=<span class="cf">function</span>(f,n,type,...){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a>  M=<span class="kw">Map</span>(f,...)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">vapply</span>(M,cbind,<span class="kw">type</span>(n)))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>我们需要知道的参数有:</p>
<p>(1)f:在函数Map中需要用到的第一个参数.</p>
<p>(2)n:在函数vapply中需要给出返回值的个数</p>
<p>(3)type:在函数vapply中需要给出的返回值的类型, 一般有:numeric,character,logical等等.</p>
<p>下面以书中对数据集mtcars各列数据进行处理的方法(除以列均值得到标准化数据)进行函数说明,用函数lapply我们可以得到下面的结果:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="kw">lapply</span>(mtcars, <span class="cf">function</span>(x) x <span class="op">/</span><span class="st"> </span><span class="kw">mean</span>(x))[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## $mpg
##  [1] 1.0452636 1.0452636 1.1348577 1.0651734 0.9307824 0.9009177 0.7117748
##  [8] 1.2144968 1.1348577 0.9556696 0.8859854 0.8163011 0.8610981 0.7565718
## [15] 0.5176544 0.5176544 0.7316846 1.6126925 1.5131436 1.6873542 1.0701509
## [22] 0.7715041 0.7565718 0.6620003 0.9556696 1.3588427 1.2941359 1.5131436
## [29] 0.7864365 0.9805569 0.7466169 1.0651734
## 
## $cyl
##  [1] 0.9696970 0.9696970 0.6464646 0.9696970 1.2929293 0.9696970 1.2929293
##  [8] 0.6464646 0.6464646 0.9696970 0.9696970 1.2929293 1.2929293 1.2929293
## [15] 1.2929293 1.2929293 1.2929293 0.6464646 0.6464646 0.6464646 0.6464646
## [22] 1.2929293 1.2929293 1.2929293 1.2929293 0.6464646 0.6464646 0.6464646
## [29] 1.2929293 0.9696970 1.2929293 0.6464646
## 
## $disp
##  [1] 0.6934756 0.6934756 0.4680961 1.1182295 1.5603202 0.9752001 1.5603202
##  [8] 0.6358305 0.6102586 0.7264157 0.7264157 1.1953786 1.1953786 1.1953786
## [15] 2.0457531 1.9937425 1.9070580 0.3411033 0.3281007 0.3081632 0.5205402
## [22] 1.3782828 1.3176037 1.5169780 1.7336891 0.3424036 0.5214070 0.4121846
## [29] 1.5213122 0.6284623 1.3046010 0.5244410</code></pre>
<p>输出结果为链表形式, 如果我们想得到向量或者矩阵形式, 首先, 我们使用Map函数：</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a>M=<span class="kw">Map</span>(<span class="st">&quot;/&quot;</span>,mtcars,<span class="kw">colMeans</span>(mtcars))</span></code></pre></div>
<p>这里的“/”便是我们框架中需要知道的参数f, 接着我们使用vapply函数将结果返回为向量或矩阵形式:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a>n=<span class="kw">nrow</span>(mtcars)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a><span class="kw">vapply</span>(M,cbind,<span class="kw">numeric</span>(n))</span></code></pre></div>
<pre><code>##             mpg       cyl      disp        hp      drat        wt      qsec
##  [1,] 1.0452636 0.9696970 0.6934756 0.7498935 1.0843688 0.8143601 0.9221934
##  [2,] 1.0452636 0.9696970 0.6934756 0.7498935 1.0843688 0.8936203 0.9535682
##  [3,] 1.1348577 0.6464646 0.4680961 0.6340009 1.0704666 0.7211128 1.0426500
##  [4,] 1.0651734 0.9696970 1.1182295 0.7498935 0.8563733 0.9993006 1.0891519
##  [5,] 0.9307824 1.2929293 1.5603202 1.1930124 0.8758363 1.0692361 0.9535682
##  [6,] 0.9009177 0.9696970 0.9752001 0.7158074 0.7673994 1.0754526 1.1328524
##  [7,] 0.7117748 1.2929293 1.5603202 1.6702173 0.8925189 1.1096433 0.8874571
##  [8,] 1.2144968 0.6464646 0.6358305 0.4226672 1.0259797 0.9915300 1.1205266
##  [9,] 1.1348577 0.6464646 0.6102586 0.6476353 1.0899296 0.9790971 1.2830030
## [10,] 0.9556696 0.9696970 0.7264157 0.8385173 1.0899296 1.0692361 1.0252819
## [11,] 0.8859854 0.9696970 0.7264157 0.8385173 1.0899296 1.0692361 1.0588977
## [12,] 0.8163011 1.2929293 1.1953786 1.2270984 0.8535928 1.2650556 0.9748582
## [13,] 0.8610981 1.2929293 1.1953786 1.2270984 0.8535928 1.1593752 0.9860634
## [14,] 0.7565718 1.2929293 1.1953786 1.2270984 0.8535928 1.1749165 1.0084740
## [15,] 0.5176544 1.2929293 2.0457531 1.3975288 0.8146668 1.6318284 1.0073535
## [16,] 0.5176544 1.2929293 1.9937425 1.4657009 0.8341298 1.6859119 0.9983892
## [17,] 0.7316846 1.2929293 1.9070580 1.5679591 0.8980798 1.6613567 0.9759787
## [18,] 1.6126925 0.6464646 0.3411033 0.4499361 1.1344165 0.6838138 1.0908327
## [19,] 1.5131436 0.6464646 0.3281007 0.3544951 1.3707533 0.5019815 1.0376077
## [20,] 1.6873542 0.6464646 0.3081632 0.4431189 1.1733426 0.5703629 1.1149240
## [21,] 1.0701509 0.6464646 0.5205402 0.6612697 1.0287601 0.7661823 1.1210869
## [22,] 0.7715041 1.2929293 1.3782828 1.0225820 0.7673994 1.0941021 0.9451642
## [23,] 0.7565718 1.2929293 1.3176037 1.0225820 0.8758363 1.0676820 0.9692556
## [24,] 0.6620003 1.2929293 1.5169780 1.6702173 1.0371014 1.1935659 0.8633658
## [25,] 0.9556696 1.2929293 1.7336891 1.1930124 0.8563733 1.1951201 0.9552490
## [26,] 1.3588427 0.6464646 0.3424036 0.4499361 1.1344165 0.6014453 1.0588977
## [27,] 1.2941359 0.6464646 0.5214070 0.6203664 1.2317317 0.6651643 0.9356398
## [28,] 1.5131436 0.6464646 0.4121846 0.7703451 1.0482231 0.4702774 0.9468450
## [29,] 0.7864365 1.2929293 1.5213122 1.7997444 1.1733426 0.9853135 0.8123818
## [30,] 0.9805569 0.9696970 0.6284623 1.1930124 1.0065166 0.8609838 0.8684082
## [31,] 0.7466169 1.2929293 1.3046010 2.2837665 0.9842732 1.1096433 0.8179845
## [32,] 1.0651734 0.6464646 0.5244410 0.7430763 1.1427578 0.8640920 1.0420898
##             vs       am      gear      carb
##  [1,] 0.000000 2.461538 1.0847458 1.4222222
##  [2,] 0.000000 2.461538 1.0847458 1.4222222
##  [3,] 2.285714 2.461538 1.0847458 0.3555556
##  [4,] 2.285714 0.000000 0.8135593 0.3555556
##  [5,] 0.000000 0.000000 0.8135593 0.7111111
##  [6,] 2.285714 0.000000 0.8135593 0.3555556
##  [7,] 0.000000 0.000000 0.8135593 1.4222222
##  [8,] 2.285714 0.000000 1.0847458 0.7111111
##  [9,] 2.285714 0.000000 1.0847458 0.7111111
## [10,] 2.285714 0.000000 1.0847458 1.4222222
## [11,] 2.285714 0.000000 1.0847458 1.4222222
## [12,] 0.000000 0.000000 0.8135593 1.0666667
## [13,] 0.000000 0.000000 0.8135593 1.0666667
## [14,] 0.000000 0.000000 0.8135593 1.0666667
## [15,] 0.000000 0.000000 0.8135593 1.4222222
## [16,] 0.000000 0.000000 0.8135593 1.4222222
## [17,] 0.000000 0.000000 0.8135593 1.4222222
## [18,] 2.285714 2.461538 1.0847458 0.3555556
## [19,] 2.285714 2.461538 1.0847458 0.7111111
## [20,] 2.285714 2.461538 1.0847458 0.3555556
## [21,] 2.285714 0.000000 0.8135593 0.3555556
## [22,] 0.000000 0.000000 0.8135593 0.7111111
## [23,] 0.000000 0.000000 0.8135593 0.7111111
## [24,] 0.000000 0.000000 0.8135593 1.4222222
## [25,] 0.000000 0.000000 0.8135593 0.7111111
## [26,] 2.285714 2.461538 1.0847458 0.3555556
## [27,] 0.000000 2.461538 1.3559322 0.7111111
## [28,] 2.285714 2.461538 1.3559322 0.7111111
## [29,] 0.000000 2.461538 1.3559322 1.4222222
## [30,] 0.000000 2.461538 1.3559322 2.1333333
## [31,] 0.000000 2.461538 1.3559322 2.8444444
## [32,] 2.285714 2.461538 1.0847458 0.7111111</code></pre>
<p>在这个函数中, 我们需要知道参数n, 即返回值的个数, 以及返回的数据类型type, 在这个例子中数据类型为numeric, 这样我们便使用Map()和vapply()函数实现了lapply()函数的功能, 并在结果的返回上有了不同类型的要求.</p>
</div>
<div id="question-discussion-3" class="section level2">
<h2>Question Discussion</h2>
<p>Write an Rcpp function for Exercise 9.4.</p>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-discussion-3" class="section level2">
<h2>Answer Discussion</h2>
<p>首先我们给出我们所写的Rcpp函数(相应cpp文件放在压缩包内):</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true"></a><span class="kw">sourceCpp</span>(<span class="dt">code=</span><span class="st">&quot;#include &lt;Rcpp.h&gt;</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true"></a><span class="st">NumericMatrix rwMC(double sigma,double x0,int N) {</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true"></a><span class="st">  mat(0,0)=x0;</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true"></a><span class="st">  mat(0,1)=0;</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true"></a><span class="st">  double y=0,u=0;</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true"></a><span class="st">  for(int i = 2; i &lt; N+1; i++) {</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true"></a><span class="st">    y=rnorm(1,mat(i-2,0),sigma)[0];</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true"></a><span class="st">    u=runif(1,0,1)[0];</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true"></a><span class="st">    if(u&lt;=exp(-abs(y))/exp(-abs(mat(i-2,0)))){</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true"></a><span class="st">      mat(i-1,0)=y;</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true"></a><span class="st">      mat(i-1,1)=mat(i-2,1);</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true"></a><span class="st">    else{</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true"></a><span class="st">      mat(i-1,0)=mat(i-2,0);</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true"></a><span class="st">      mat(i-1,1)=mat(i-2,1)+1;</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true"></a><span class="st">  }</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true"></a><span class="st">  return(mat);</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true"></a><span class="st">}&quot;</span>)</span></code></pre></div>
<p>同时我们回顾之前写过的R函数:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a>rw.Metropolis=<span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true"></a>  f=<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true"></a>  x=<span class="kw">numeric</span>(N)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true"></a>  x[<span class="dv">1</span>]=x0</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true"></a>  u=<span class="kw">runif</span>(N)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true"></a>  k=<span class="dv">0</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true"></a>    y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="kw">f</span>(y)<span class="op">/</span><span class="kw">f</span>(x[i<span class="dv">-1</span>])) x[i]=y</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true"></a>    <span class="cf">else</span>{</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true"></a>      x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true"></a>      k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true"></a>    }</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true"></a>  }</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true"></a>}</span></code></pre></div>
<p>运用这两个函数对题目进行模拟, 首先是R函数:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a>N=<span class="dv">2000</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true"></a>sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true"></a>x0=<span class="dv">25</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true"></a>rw1=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true"></a>rw2=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true"></a>rw3=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true"></a>rw4=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9835 0.8245 0.5365 0.1030</code></pre>
<p>接着是Rcpp函数:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a>rwc1=<span class="kw">rwMC</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true"></a>rwc2=<span class="kw">rwMC</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true"></a>rwc3=<span class="kw">rwMC</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true"></a>rwc4=<span class="kw">rwMC</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true"></a><span class="kw">plot</span>(rwc1[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a><span class="kw">plot</span>(rwc2[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a><span class="kw">plot</span>(rwc3[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a><span class="kw">plot</span>(rwc4[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rwc1[N,<span class="dv">2</span>]<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rwc2[N,<span class="dv">2</span>]<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rwc3[N,<span class="dv">2</span>]<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rwc4[N,<span class="dv">2</span>]<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9780 0.8405 0.5385 0.0970</code></pre>
<p>我们使用函数qqplot对两种方法的随机数进行比较:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a><span class="kw">qqplot</span>(rw1<span class="op">$</span>x,rwc1[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true"></a><span class="kw">qqplot</span>(rw2<span class="op">$</span>x,rwc2[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a><span class="kw">qqplot</span>(rw3<span class="op">$</span>x,rwc3[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a><span class="kw">qqplot</span>(rw4<span class="op">$</span>x,rwc4[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>我们使用函数microbenchmark比较二者的运行速度:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a>ts1=<span class="kw">microbenchmark</span>(<span class="dt">rw=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">rwc=</span><span class="kw">rwMC</span>(sigma[<span class="dv">1</span>],x0,N))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true"></a><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq median     uq
## 1   rw 6912.65 7199.3 7854.5
## 2  rwc  438.35  462.4  505.6</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a>ts2=<span class="kw">microbenchmark</span>(<span class="dt">rw=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N),<span class="dt">rwc=</span><span class="kw">rwMC</span>(sigma[<span class="dv">2</span>],x0,N))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true"></a><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1   rw 6729.45 6961.25 7484.25
## 2  rwc  480.00  494.45  509.60</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true"></a>ts3=<span class="kw">microbenchmark</span>(<span class="dt">rw=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N),<span class="dt">rwc=</span><span class="kw">rwMC</span>(sigma[<span class="dv">3</span>],x0,N))</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true"></a><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr     lq  median      uq
## 1   rw 6892.8 7093.75 7705.80
## 2  rwc  485.3  495.80  506.05</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true"></a>ts4=<span class="kw">microbenchmark</span>(<span class="dt">rw=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N),<span class="dt">rwc=</span><span class="kw">rwMC</span>(sigma[<span class="dv">4</span>],x0,N))</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true"></a><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1   rw 6361.55 6637.90 7468.40
## 2  rwc  430.65  445.65  484.05</code></pre>
<p>通过以上的一系列比较可以发现, 我们使用Rcpp所得到的结果与直接使用R的结果相差无异, 但是在运行速度上, 使用Rcpp可以极大的缩短运行速度, 从而提高工作效率.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
